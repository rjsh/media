<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>vaapi_h264.c source code [ffmpeg/libavcodec/vaapi_h264.c] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="DPB "/>
<link rel="stylesheet" href="../../../data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="../../../data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="../../../data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="../../../data/jquery/jquery-ui.min.js"></script>
<script>var file = 'ffmpeg/libavcodec/vaapi_h264.c'; var root_path = '../..'; var data_path = '../../../data';</script>
<script src='../../../data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='..'>ffmpeg</a>/<a href='./'>libavcodec</a>/<a href='vaapi_h264.c.html'>vaapi_h264.c</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i> * H.264 HW decode acceleration through VA API</i></td></tr>
<tr><th id="3">3</th><td><i> *</i></td></tr>
<tr><th id="4">4</th><td><i> * Copyright (C) 2008-2009 Splitted-Desktop Systems</i></td></tr>
<tr><th id="5">5</th><td><i> *</i></td></tr>
<tr><th id="6">6</th><td><i> * This file is part of FFmpeg.</i></td></tr>
<tr><th id="7">7</th><td><i> *</i></td></tr>
<tr><th id="8">8</th><td><i> * FFmpeg is free software; you can redistribute it and/or</i></td></tr>
<tr><th id="9">9</th><td><i> * modify it under the terms of the GNU Lesser General Public</i></td></tr>
<tr><th id="10">10</th><td><i> * License as published by the Free Software Foundation; either</i></td></tr>
<tr><th id="11">11</th><td><i> * version 2.1 of the License, or (at your option) any later version.</i></td></tr>
<tr><th id="12">12</th><td><i> *</i></td></tr>
<tr><th id="13">13</th><td><i> * FFmpeg is distributed in the hope that it will be useful,</i></td></tr>
<tr><th id="14">14</th><td><i> * but WITHOUT ANY WARRANTY; without even the implied warranty of</i></td></tr>
<tr><th id="15">15</th><td><i> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</i></td></tr>
<tr><th id="16">16</th><td><i> * Lesser General Public License for more details.</i></td></tr>
<tr><th id="17">17</th><td><i> *</i></td></tr>
<tr><th id="18">18</th><td><i> * You should have received a copy of the GNU Lesser General Public</i></td></tr>
<tr><th id="19">19</th><td><i> * License along with FFmpeg; if not, write to the Free Software</i></td></tr>
<tr><th id="20">20</th><td><i> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</i></td></tr>
<tr><th id="21">21</th><td><i> */</i></td></tr>
<tr><th id="22">22</th><td></td></tr>
<tr><th id="23">23</th><td><u>#include <a href="vaapi_internal.h.html">"vaapi_internal.h"</a></u></td></tr>
<tr><th id="24">24</th><td><u>#include <a href="h264dec.h.html">"h264dec.h"</a></u></td></tr>
<tr><th id="25">25</th><td><u>#include <a href="h264_ps.h.html">"h264_ps.h"</a></u></td></tr>
<tr><th id="26">26</th><td><u>#include <a href="mpegutils.h.html">"mpegutils.h"</a></u></td></tr>
<tr><th id="27">27</th><td></td></tr>
<tr><th id="28">28</th><td><i class="doc">/**</i></td></tr>
<tr><th id="29">29</th><td><i class="doc"> *<span class="command"> @file</span></i></td></tr>
<tr><th id="30">30</th><td><i class="doc"> * This file implements the glue code between FFmpeg's and VA API's</i></td></tr>
<tr><th id="31">31</th><td><i class="doc"> * structures for H.264 decoding.</i></td></tr>
<tr><th id="32">32</th><td><i class="doc"> */</i></td></tr>
<tr><th id="33">33</th><td></td></tr>
<tr><th id="34">34</th><td><i class="doc" data-doc="init_vaapi_pic">/**</i></td></tr>
<tr><th id="35">35</th><td><i class="doc" data-doc="init_vaapi_pic"> * Initialize an empty VA API picture.</i></td></tr>
<tr><th id="36">36</th><td><i class="doc" data-doc="init_vaapi_pic"> *</i></td></tr>
<tr><th id="37">37</th><td><i class="doc" data-doc="init_vaapi_pic"> * VA API requires a fixed-size reference picture array.</i></td></tr>
<tr><th id="38">38</th><td><i class="doc" data-doc="init_vaapi_pic"> */</i></td></tr>
<tr><th id="39">39</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="init_vaapi_pic" title='init_vaapi_pic' data-type='void init_vaapi_pic(VAPictureH264 * va_pic)' data-ref="init_vaapi_pic">init_vaapi_pic</dfn>(<a class="typedef" href="../../include/va/va.h.html#VAPictureH264" title='VAPictureH264' data-type='struct _VAPictureH264' data-ref="VAPictureH264">VAPictureH264</a> *<dfn class="local col1 decl" id="1va_pic" title='va_pic' data-type='VAPictureH264 *' data-ref="1va_pic">va_pic</dfn>)</td></tr>
<tr><th id="40">40</th><td>{</td></tr>
<tr><th id="41">41</th><td>    <a class="local col1 ref" href="#1va_pic" title='va_pic' data-ref="1va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::picture_id" title='_VAPictureH264::picture_id' data-ref="_VAPictureH264::picture_id">picture_id</a>          = <a class="macro" href="../../include/va/va.h.html#598" title="0xffffffff" data-ref="_M/VA_INVALID_ID">VA_INVALID_ID</a>;</td></tr>
<tr><th id="42">42</th><td>    <a class="local col1 ref" href="#1va_pic" title='va_pic' data-ref="1va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::flags" title='_VAPictureH264::flags' data-ref="_VAPictureH264::flags">flags</a>               = <a class="macro" href="../../include/va/va.h.html#1508" title="0x00000001" data-ref="_M/VA_PICTURE_H264_INVALID">VA_PICTURE_H264_INVALID</a>;</td></tr>
<tr><th id="43">43</th><td>    <a class="local col1 ref" href="#1va_pic" title='va_pic' data-ref="1va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::TopFieldOrderCnt" title='_VAPictureH264::TopFieldOrderCnt' data-ref="_VAPictureH264::TopFieldOrderCnt">TopFieldOrderCnt</a>    = <var>0</var>;</td></tr>
<tr><th id="44">44</th><td>    <a class="local col1 ref" href="#1va_pic" title='va_pic' data-ref="1va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::BottomFieldOrderCnt" title='_VAPictureH264::BottomFieldOrderCnt' data-ref="_VAPictureH264::BottomFieldOrderCnt">BottomFieldOrderCnt</a> = <var>0</var>;</td></tr>
<tr><th id="45">45</th><td>}</td></tr>
<tr><th id="46">46</th><td></td></tr>
<tr><th id="47">47</th><td><i class="doc" data-doc="fill_vaapi_pic">/**</i></td></tr>
<tr><th id="48">48</th><td><i class="doc" data-doc="fill_vaapi_pic"> * Translate an FFmpeg Picture into its VA API form.</i></td></tr>
<tr><th id="49">49</th><td><i class="doc" data-doc="fill_vaapi_pic"> *</i></td></tr>
<tr><th id="50">50</th><td><i class="doc" data-doc="fill_vaapi_pic"> * <span class="command">@param</span>[out] <span class="arg">va_pic</span>          A pointer to VA API's own picture struct</i></td></tr>
<tr><th id="51">51</th><td><i class="doc" data-doc="fill_vaapi_pic"> * <span class="command">@param</span>[in]  <span class="arg">pic</span>             A pointer to the FFmpeg picture struct to convert</i></td></tr>
<tr><th id="52">52</th><td><i class="doc" data-doc="fill_vaapi_pic"> * <span class="command">@param</span>[in]  <span class="arg">pic_structure</span>   The picture field type (as defined in mpegvideo.h),</i></td></tr>
<tr><th id="53">53</th><td><i class="doc" data-doc="fill_vaapi_pic"> *                             supersedes pic's field type if nonzero.</i></td></tr>
<tr><th id="54">54</th><td><i class="doc" data-doc="fill_vaapi_pic"> */</i></td></tr>
<tr><th id="55">55</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="fill_vaapi_pic" title='fill_vaapi_pic' data-type='void fill_vaapi_pic(VAPictureH264 * va_pic, H264Picture * pic, int pic_structure)' data-ref="fill_vaapi_pic">fill_vaapi_pic</dfn>(<a class="typedef" href="../../include/va/va.h.html#VAPictureH264" title='VAPictureH264' data-type='struct _VAPictureH264' data-ref="VAPictureH264">VAPictureH264</a> *<dfn class="local col2 decl" id="2va_pic" title='va_pic' data-type='VAPictureH264 *' data-ref="2va_pic">va_pic</dfn>,</td></tr>
<tr><th id="56">56</th><td>                           <a class="typedef" href="h264dec.h.html#H264Picture" title='H264Picture' data-type='struct H264Picture' data-ref="H264Picture">H264Picture</a>   *<dfn class="local col3 decl" id="3pic" title='pic' data-type='H264Picture *' data-ref="3pic">pic</dfn>,</td></tr>
<tr><th id="57">57</th><td>                           <em>int</em>            <dfn class="local col4 decl" id="4pic_structure" title='pic_structure' data-type='int' data-ref="4pic_structure">pic_structure</dfn>)</td></tr>
<tr><th id="58">58</th><td>{</td></tr>
<tr><th id="59">59</th><td>    <b>if</b> (<a class="local col4 ref" href="#4pic_structure" title='pic_structure' data-ref="4pic_structure">pic_structure</a> == <var>0</var>)</td></tr>
<tr><th id="60">60</th><td>        <a class="local col4 ref" href="#4pic_structure" title='pic_structure' data-ref="4pic_structure">pic_structure</a> = <a class="local col3 ref" href="#3pic" title='pic' data-ref="3pic">pic</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::reference" title='H264Picture::reference' data-ref="H264Picture::reference">reference</a>;</td></tr>
<tr><th id="61">61</th><td>    <a class="local col4 ref" href="#4pic_structure" title='pic_structure' data-ref="4pic_structure">pic_structure</a> &amp;= <a class="macro" href="mpegutils.h.html#39" title="3" data-ref="_M/PICT_FRAME">PICT_FRAME</a>; <i>/* PICT_TOP_FIELD|PICT_BOTTOM_FIELD */</i></td></tr>
<tr><th id="62">62</th><td></td></tr>
<tr><th id="63">63</th><td>    <a class="local col2 ref" href="#2va_pic" title='va_pic' data-ref="2va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::picture_id" title='_VAPictureH264::picture_id' data-ref="_VAPictureH264::picture_id">picture_id</a> = <a class="ref" href="vaapi_internal.h.html#ff_vaapi_get_surface_id" title='ff_vaapi_get_surface_id' data-ref="ff_vaapi_get_surface_id">ff_vaapi_get_surface_id</a>(<a class="local col3 ref" href="#3pic" title='pic' data-ref="3pic">pic</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::f" title='H264Picture::f' data-ref="H264Picture::f">f</a>);</td></tr>
<tr><th id="64">64</th><td>    <a class="local col2 ref" href="#2va_pic" title='va_pic' data-ref="2va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::frame_idx" title='_VAPictureH264::frame_idx' data-ref="_VAPictureH264::frame_idx">frame_idx</a>  = <a class="local col3 ref" href="#3pic" title='pic' data-ref="3pic">pic</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::long_ref" title='H264Picture::long_ref' data-ref="H264Picture::long_ref">long_ref</a> ? <a class="local col3 ref" href="#3pic" title='pic' data-ref="3pic">pic</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::pic_id" title='H264Picture::pic_id' data-ref="H264Picture::pic_id">pic_id</a> : <a class="local col3 ref" href="#3pic" title='pic' data-ref="3pic">pic</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::frame_num" title='H264Picture::frame_num' data-ref="H264Picture::frame_num">frame_num</a>;</td></tr>
<tr><th id="65">65</th><td></td></tr>
<tr><th id="66">66</th><td>    <a class="local col2 ref" href="#2va_pic" title='va_pic' data-ref="2va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::flags" title='_VAPictureH264::flags' data-ref="_VAPictureH264::flags">flags</a>      = <var>0</var>;</td></tr>
<tr><th id="67">67</th><td>    <b>if</b> (<a class="local col4 ref" href="#4pic_structure" title='pic_structure' data-ref="4pic_structure">pic_structure</a> != <a class="macro" href="mpegutils.h.html#39" title="3" data-ref="_M/PICT_FRAME">PICT_FRAME</a>)</td></tr>
<tr><th id="68">68</th><td>        <a class="local col2 ref" href="#2va_pic" title='va_pic' data-ref="2va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::flags" title='_VAPictureH264::flags' data-ref="_VAPictureH264::flags">flags</a> |= (<a class="local col4 ref" href="#4pic_structure" title='pic_structure' data-ref="4pic_structure">pic_structure</a> &amp; <a class="macro" href="mpegutils.h.html#37" title="1" data-ref="_M/PICT_TOP_FIELD">PICT_TOP_FIELD</a>) ? <a class="macro" href="../../include/va/va.h.html#1509" title="0x00000002" data-ref="_M/VA_PICTURE_H264_TOP_FIELD">VA_PICTURE_H264_TOP_FIELD</a> : <a class="macro" href="../../include/va/va.h.html#1510" title="0x00000004" data-ref="_M/VA_PICTURE_H264_BOTTOM_FIELD">VA_PICTURE_H264_BOTTOM_FIELD</a>;</td></tr>
<tr><th id="69">69</th><td>    <b>if</b> (<a class="local col3 ref" href="#3pic" title='pic' data-ref="3pic">pic</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::reference" title='H264Picture::reference' data-ref="H264Picture::reference">reference</a>)</td></tr>
<tr><th id="70">70</th><td>        <a class="local col2 ref" href="#2va_pic" title='va_pic' data-ref="2va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::flags" title='_VAPictureH264::flags' data-ref="_VAPictureH264::flags">flags</a> |= <a class="local col3 ref" href="#3pic" title='pic' data-ref="3pic">pic</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::long_ref" title='H264Picture::long_ref' data-ref="H264Picture::long_ref">long_ref</a> ? <a class="macro" href="../../include/va/va.h.html#1512" title="0x00000010" data-ref="_M/VA_PICTURE_H264_LONG_TERM_REFERENCE">VA_PICTURE_H264_LONG_TERM_REFERENCE</a> : <a class="macro" href="../../include/va/va.h.html#1511" title="0x00000008" data-ref="_M/VA_PICTURE_H264_SHORT_TERM_REFERENCE">VA_PICTURE_H264_SHORT_TERM_REFERENCE</a>;</td></tr>
<tr><th id="71">71</th><td></td></tr>
<tr><th id="72">72</th><td>    <a class="local col2 ref" href="#2va_pic" title='va_pic' data-ref="2va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::TopFieldOrderCnt" title='_VAPictureH264::TopFieldOrderCnt' data-ref="_VAPictureH264::TopFieldOrderCnt">TopFieldOrderCnt</a> = <var>0</var>;</td></tr>
<tr><th id="73">73</th><td>    <b>if</b> (<a class="local col3 ref" href="#3pic" title='pic' data-ref="3pic">pic</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::field_poc" title='H264Picture::field_poc' data-ref="H264Picture::field_poc">field_poc</a>[<var>0</var>] != <span class="macro" title="2147483647" data-ref="_M/INT_MAX">INT_MAX</span>)</td></tr>
<tr><th id="74">74</th><td>        <a class="local col2 ref" href="#2va_pic" title='va_pic' data-ref="2va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::TopFieldOrderCnt" title='_VAPictureH264::TopFieldOrderCnt' data-ref="_VAPictureH264::TopFieldOrderCnt">TopFieldOrderCnt</a> = <a class="local col3 ref" href="#3pic" title='pic' data-ref="3pic">pic</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::field_poc" title='H264Picture::field_poc' data-ref="H264Picture::field_poc">field_poc</a>[<var>0</var>];</td></tr>
<tr><th id="75">75</th><td></td></tr>
<tr><th id="76">76</th><td>    <a class="local col2 ref" href="#2va_pic" title='va_pic' data-ref="2va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::BottomFieldOrderCnt" title='_VAPictureH264::BottomFieldOrderCnt' data-ref="_VAPictureH264::BottomFieldOrderCnt">BottomFieldOrderCnt</a> = <var>0</var>;</td></tr>
<tr><th id="77">77</th><td>    <b>if</b> (<a class="local col3 ref" href="#3pic" title='pic' data-ref="3pic">pic</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::field_poc" title='H264Picture::field_poc' data-ref="H264Picture::field_poc">field_poc</a>[<var>1</var>] != <span class="macro" title="2147483647" data-ref="_M/INT_MAX">INT_MAX</span>)</td></tr>
<tr><th id="78">78</th><td>        <a class="local col2 ref" href="#2va_pic" title='va_pic' data-ref="2va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::BottomFieldOrderCnt" title='_VAPictureH264::BottomFieldOrderCnt' data-ref="_VAPictureH264::BottomFieldOrderCnt">BottomFieldOrderCnt</a> = <a class="local col3 ref" href="#3pic" title='pic' data-ref="3pic">pic</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::field_poc" title='H264Picture::field_poc' data-ref="H264Picture::field_poc">field_poc</a>[<var>1</var>];</td></tr>
<tr><th id="79">79</th><td>}</td></tr>
<tr><th id="80">80</th><td></td></tr>
<tr><th id="81">81</th><td><i class="doc">/** Decoded Picture Buffer (DPB). */</i></td></tr>
<tr><th id="82">82</th><td><b>typedef</b> <b>struct</b> <dfn class="type def" id="DPB" title='DPB' data-ref="DPB"><a class="type" href="#DPB" title='DPB' data-ref="DPB">DPB</a></dfn> {</td></tr>
<tr><th id="83">83</th><td>    <em>int</em>            <dfn class="tu decl" id="DPB::size" title='DPB::size' data-type='int' data-ref="DPB::size">size</dfn>;        <i class="doc" data-doc="DPB::size">///&lt; Current number of reference frames in the DPB</i></td></tr>
<tr><th id="84">84</th><td>    <em>int</em>            <dfn class="tu decl" id="DPB::max_size" title='DPB::max_size' data-type='int' data-ref="DPB::max_size">max_size</dfn>;    <i class="doc" data-doc="DPB::max_size">///&lt; Max number of reference frames. This is FF_ARRAY_ELEMS(VAPictureParameterBufferH264.ReferenceFrames)</i></td></tr>
<tr><th id="85">85</th><td>    <a class="typedef" href="../../include/va/va.h.html#VAPictureH264" title='VAPictureH264' data-type='struct _VAPictureH264' data-ref="VAPictureH264">VAPictureH264</a> *<dfn class="tu decl" id="DPB::va_pics" title='DPB::va_pics' data-type='VAPictureH264 *' data-ref="DPB::va_pics">va_pics</dfn>;     <i class="doc" data-doc="DPB::va_pics">///&lt; Pointer to VAPictureParameterBufferH264.ReferenceFrames array</i></td></tr>
<tr><th id="86">86</th><td>} <dfn class="typedef" id="DPB" title='DPB' data-type='struct DPB' data-ref="DPB">DPB</dfn>;</td></tr>
<tr><th id="87">87</th><td></td></tr>
<tr><th id="88">88</th><td><i class="doc" data-doc="dpb_add">/**</i></td></tr>
<tr><th id="89">89</th><td><i class="doc" data-doc="dpb_add"> * Append picture to the decoded picture buffer, in a VA API form that</i></td></tr>
<tr><th id="90">90</th><td><i class="doc" data-doc="dpb_add"> * merges the second field picture attributes with the first, if</i></td></tr>
<tr><th id="91">91</th><td><i class="doc" data-doc="dpb_add"> * available.  The decoded picture buffer's size must be large enough</i></td></tr>
<tr><th id="92">92</th><td><i class="doc" data-doc="dpb_add"> * to receive the new VA API picture object.</i></td></tr>
<tr><th id="93">93</th><td><i class="doc" data-doc="dpb_add"> */</i></td></tr>
<tr><th id="94">94</th><td><em>static</em> <em>int</em> <dfn class="tu decl def" id="dpb_add" title='dpb_add' data-type='int dpb_add(DPB * dpb, H264Picture * pic)' data-ref="dpb_add">dpb_add</dfn>(<a class="typedef" href="#DPB" title='DPB' data-type='struct DPB' data-ref="DPB">DPB</a> *<dfn class="local col5 decl" id="5dpb" title='dpb' data-type='DPB *' data-ref="5dpb">dpb</dfn>, <a class="typedef" href="h264dec.h.html#H264Picture" title='H264Picture' data-type='struct H264Picture' data-ref="H264Picture">H264Picture</a> *<dfn class="local col6 decl" id="6pic" title='pic' data-type='H264Picture *' data-ref="6pic">pic</dfn>)</td></tr>
<tr><th id="95">95</th><td>{</td></tr>
<tr><th id="96">96</th><td>    <em>int</em> <dfn class="local col7 decl" id="7i" title='i' data-type='int' data-ref="7i">i</dfn>;</td></tr>
<tr><th id="97">97</th><td></td></tr>
<tr><th id="98">98</th><td>    <b>if</b> (<a class="local col5 ref" href="#5dpb" title='dpb' data-ref="5dpb">dpb</a>-&gt;<a class="tu ref" href="#DPB::size" title='DPB::size' data-use='r' data-ref="DPB::size">size</a> &gt;= <a class="local col5 ref" href="#5dpb" title='dpb' data-ref="5dpb">dpb</a>-&gt;<a class="tu ref" href="#DPB::max_size" title='DPB::max_size' data-use='r' data-ref="DPB::max_size">max_size</a>)</td></tr>
<tr><th id="99">99</th><td>        <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="100">100</th><td></td></tr>
<tr><th id="101">101</th><td>    <b>for</b> (<a class="local col7 ref" href="#7i" title='i' data-ref="7i">i</a> = <var>0</var>; <a class="local col7 ref" href="#7i" title='i' data-ref="7i">i</a> &lt; <a class="local col5 ref" href="#5dpb" title='dpb' data-ref="5dpb">dpb</a>-&gt;<a class="tu ref" href="#DPB::size" title='DPB::size' data-use='r' data-ref="DPB::size">size</a>; <a class="local col7 ref" href="#7i" title='i' data-ref="7i">i</a>++) {</td></tr>
<tr><th id="102">102</th><td>        <a class="typedef" href="../../include/va/va.h.html#VAPictureH264" title='VAPictureH264' data-type='struct _VAPictureH264' data-ref="VAPictureH264">VAPictureH264</a> * <em>const</em> <dfn class="local col8 decl" id="8va_pic" title='va_pic' data-type='VAPictureH264 *const' data-ref="8va_pic">va_pic</dfn> = &amp;<a class="local col5 ref" href="#5dpb" title='dpb' data-ref="5dpb">dpb</a>-&gt;<a class="tu ref" href="#DPB::va_pics" title='DPB::va_pics' data-use='r' data-ref="DPB::va_pics">va_pics</a>[<a class="local col7 ref" href="#7i" title='i' data-ref="7i">i</a>];</td></tr>
<tr><th id="103">103</th><td>        <b>if</b> (<a class="local col8 ref" href="#8va_pic" title='va_pic' data-ref="8va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::picture_id" title='_VAPictureH264::picture_id' data-ref="_VAPictureH264::picture_id">picture_id</a> == <a class="ref" href="vaapi_internal.h.html#ff_vaapi_get_surface_id" title='ff_vaapi_get_surface_id' data-ref="ff_vaapi_get_surface_id">ff_vaapi_get_surface_id</a>(<a class="local col6 ref" href="#6pic" title='pic' data-ref="6pic">pic</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::f" title='H264Picture::f' data-ref="H264Picture::f">f</a>)) {</td></tr>
<tr><th id="104">104</th><td>            <a class="typedef" href="../../include/va/va.h.html#VAPictureH264" title='VAPictureH264' data-type='struct _VAPictureH264' data-ref="VAPictureH264">VAPictureH264</a> <dfn class="local col9 decl" id="9temp_va_pic" title='temp_va_pic' data-type='VAPictureH264' data-ref="9temp_va_pic">temp_va_pic</dfn>;</td></tr>
<tr><th id="105">105</th><td>            <a class="tu ref" href="#fill_vaapi_pic" title='fill_vaapi_pic' data-use='c' data-ref="fill_vaapi_pic">fill_vaapi_pic</a>(&amp;<a class="local col9 ref" href="#9temp_va_pic" title='temp_va_pic' data-ref="9temp_va_pic">temp_va_pic</a>, <a class="local col6 ref" href="#6pic" title='pic' data-ref="6pic">pic</a>, <var>0</var>);</td></tr>
<tr><th id="106">106</th><td></td></tr>
<tr><th id="107">107</th><td>            <b>if</b> ((<a class="local col9 ref" href="#9temp_va_pic" title='temp_va_pic' data-ref="9temp_va_pic">temp_va_pic</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::flags" title='_VAPictureH264::flags' data-ref="_VAPictureH264::flags">flags</a> ^ <a class="local col8 ref" href="#8va_pic" title='va_pic' data-ref="8va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::flags" title='_VAPictureH264::flags' data-ref="_VAPictureH264::flags">flags</a>) &amp; (<a class="macro" href="../../include/va/va.h.html#1509" title="0x00000002" data-ref="_M/VA_PICTURE_H264_TOP_FIELD">VA_PICTURE_H264_TOP_FIELD</a> | <a class="macro" href="../../include/va/va.h.html#1510" title="0x00000004" data-ref="_M/VA_PICTURE_H264_BOTTOM_FIELD">VA_PICTURE_H264_BOTTOM_FIELD</a>)) {</td></tr>
<tr><th id="108">108</th><td>                <a class="local col8 ref" href="#8va_pic" title='va_pic' data-ref="8va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::flags" title='_VAPictureH264::flags' data-ref="_VAPictureH264::flags">flags</a> |= <a class="local col9 ref" href="#9temp_va_pic" title='temp_va_pic' data-ref="9temp_va_pic">temp_va_pic</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::flags" title='_VAPictureH264::flags' data-ref="_VAPictureH264::flags">flags</a> &amp; (<a class="macro" href="../../include/va/va.h.html#1509" title="0x00000002" data-ref="_M/VA_PICTURE_H264_TOP_FIELD">VA_PICTURE_H264_TOP_FIELD</a> | <a class="macro" href="../../include/va/va.h.html#1510" title="0x00000004" data-ref="_M/VA_PICTURE_H264_BOTTOM_FIELD">VA_PICTURE_H264_BOTTOM_FIELD</a>);</td></tr>
<tr><th id="109">109</th><td>                <i>/* Merge second field */</i></td></tr>
<tr><th id="110">110</th><td>                <b>if</b> (<a class="local col9 ref" href="#9temp_va_pic" title='temp_va_pic' data-ref="9temp_va_pic">temp_va_pic</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::flags" title='_VAPictureH264::flags' data-ref="_VAPictureH264::flags">flags</a> &amp; <a class="macro" href="../../include/va/va.h.html#1509" title="0x00000002" data-ref="_M/VA_PICTURE_H264_TOP_FIELD">VA_PICTURE_H264_TOP_FIELD</a>) {</td></tr>
<tr><th id="111">111</th><td>                    <a class="local col8 ref" href="#8va_pic" title='va_pic' data-ref="8va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::TopFieldOrderCnt" title='_VAPictureH264::TopFieldOrderCnt' data-ref="_VAPictureH264::TopFieldOrderCnt">TopFieldOrderCnt</a>    = <a class="local col9 ref" href="#9temp_va_pic" title='temp_va_pic' data-ref="9temp_va_pic">temp_va_pic</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::TopFieldOrderCnt" title='_VAPictureH264::TopFieldOrderCnt' data-ref="_VAPictureH264::TopFieldOrderCnt">TopFieldOrderCnt</a>;</td></tr>
<tr><th id="112">112</th><td>                } <b>else</b> {</td></tr>
<tr><th id="113">113</th><td>                    <a class="local col8 ref" href="#8va_pic" title='va_pic' data-ref="8va_pic">va_pic</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::BottomFieldOrderCnt" title='_VAPictureH264::BottomFieldOrderCnt' data-ref="_VAPictureH264::BottomFieldOrderCnt">BottomFieldOrderCnt</a> = <a class="local col9 ref" href="#9temp_va_pic" title='temp_va_pic' data-ref="9temp_va_pic">temp_va_pic</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureH264::BottomFieldOrderCnt" title='_VAPictureH264::BottomFieldOrderCnt' data-ref="_VAPictureH264::BottomFieldOrderCnt">BottomFieldOrderCnt</a>;</td></tr>
<tr><th id="114">114</th><td>                }</td></tr>
<tr><th id="115">115</th><td>            }</td></tr>
<tr><th id="116">116</th><td>            <b>return</b> <var>0</var>;</td></tr>
<tr><th id="117">117</th><td>        }</td></tr>
<tr><th id="118">118</th><td>    }</td></tr>
<tr><th id="119">119</th><td></td></tr>
<tr><th id="120">120</th><td>    <a class="tu ref" href="#fill_vaapi_pic" title='fill_vaapi_pic' data-use='c' data-ref="fill_vaapi_pic">fill_vaapi_pic</a>(&amp;<a class="local col5 ref" href="#5dpb" title='dpb' data-ref="5dpb">dpb</a>-&gt;<a class="tu ref" href="#DPB::va_pics" title='DPB::va_pics' data-use='r' data-ref="DPB::va_pics">va_pics</a>[<a class="local col5 ref" href="#5dpb" title='dpb' data-ref="5dpb">dpb</a>-&gt;<a class="tu ref" href="#DPB::size" title='DPB::size' data-use='w' data-ref="DPB::size">size</a>++], <a class="local col6 ref" href="#6pic" title='pic' data-ref="6pic">pic</a>, <var>0</var>);</td></tr>
<tr><th id="121">121</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="122">122</th><td>}</td></tr>
<tr><th id="123">123</th><td></td></tr>
<tr><th id="124">124</th><td><i class="doc" data-doc="fill_vaapi_ReferenceFrames">/** Fill in VA API reference frames array. */</i></td></tr>
<tr><th id="125">125</th><td><em>static</em> <em>int</em> <dfn class="tu decl def" id="fill_vaapi_ReferenceFrames" title='fill_vaapi_ReferenceFrames' data-type='int fill_vaapi_ReferenceFrames(VAPictureParameterBufferH264 * pic_param, H264Context * h)' data-ref="fill_vaapi_ReferenceFrames">fill_vaapi_ReferenceFrames</dfn>(<a class="typedef" href="../../include/va/va.h.html#VAPictureParameterBufferH264" title='VAPictureParameterBufferH264' data-type='struct _VAPictureParameterBufferH264' data-ref="VAPictureParameterBufferH264">VAPictureParameterBufferH264</a> *<dfn class="local col0 decl" id="10pic_param" title='pic_param' data-type='VAPictureParameterBufferH264 *' data-ref="10pic_param">pic_param</dfn>,</td></tr>
<tr><th id="126">126</th><td>                                      <a class="typedef" href="h264dec.h.html#H264Context" title='H264Context' data-type='struct H264Context' data-ref="H264Context">H264Context</a>                  *<dfn class="local col1 decl" id="11h" title='h' data-type='H264Context *' data-ref="11h">h</dfn>)</td></tr>
<tr><th id="127">127</th><td>{</td></tr>
<tr><th id="128">128</th><td>    <a class="typedef" href="#DPB" title='DPB' data-type='struct DPB' data-ref="DPB">DPB</a> <dfn class="local col2 decl" id="12dpb" title='dpb' data-type='DPB' data-ref="12dpb">dpb</dfn>;</td></tr>
<tr><th id="129">129</th><td>    <em>int</em> <dfn class="local col3 decl" id="13i" title='i' data-type='int' data-ref="13i">i</dfn>;</td></tr>
<tr><th id="130">130</th><td></td></tr>
<tr><th id="131">131</th><td>    <a class="local col2 ref" href="#12dpb" title='dpb' data-ref="12dpb">dpb</a>.<a class="tu ref" href="#DPB::size" title='DPB::size' data-use='w' data-ref="DPB::size">size</a>     = <var>0</var>;</td></tr>
<tr><th id="132">132</th><td>    <a class="local col2 ref" href="#12dpb" title='dpb' data-ref="12dpb">dpb</a>.<a class="tu ref" href="#DPB::max_size" title='DPB::max_size' data-use='w' data-ref="DPB::max_size">max_size</a> = <a class="macro" href="../libavutil/common.h.html#100" title="(sizeof(pic_param-&gt;ReferenceFrames) / sizeof((pic_param-&gt;ReferenceFrames)[0]))" data-ref="_M/FF_ARRAY_ELEMS">FF_ARRAY_ELEMS</a>(<a class="local col0 ref" href="#10pic_param" title='pic_param' data-ref="10pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::ReferenceFrames" title='_VAPictureParameterBufferH264::ReferenceFrames' data-ref="_VAPictureParameterBufferH264::ReferenceFrames">ReferenceFrames</a>);</td></tr>
<tr><th id="133">133</th><td>    <a class="local col2 ref" href="#12dpb" title='dpb' data-ref="12dpb">dpb</a>.<a class="tu ref" href="#DPB::va_pics" title='DPB::va_pics' data-use='w' data-ref="DPB::va_pics">va_pics</a>  = <a class="local col0 ref" href="#10pic_param" title='pic_param' data-ref="10pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::ReferenceFrames" title='_VAPictureParameterBufferH264::ReferenceFrames' data-ref="_VAPictureParameterBufferH264::ReferenceFrames">ReferenceFrames</a>;</td></tr>
<tr><th id="134">134</th><td>    <b>for</b> (<a class="local col3 ref" href="#13i" title='i' data-ref="13i">i</a> = <var>0</var>; <a class="local col3 ref" href="#13i" title='i' data-ref="13i">i</a> &lt; <a class="local col2 ref" href="#12dpb" title='dpb' data-ref="12dpb">dpb</a>.<a class="tu ref" href="#DPB::max_size" title='DPB::max_size' data-use='r' data-ref="DPB::max_size">max_size</a>; <a class="local col3 ref" href="#13i" title='i' data-ref="13i">i</a>++)</td></tr>
<tr><th id="135">135</th><td>        <a class="tu ref" href="#init_vaapi_pic" title='init_vaapi_pic' data-use='c' data-ref="init_vaapi_pic">init_vaapi_pic</a>(&amp;<a class="local col2 ref" href="#12dpb" title='dpb' data-ref="12dpb">dpb</a>.<a class="tu ref" href="#DPB::va_pics" title='DPB::va_pics' data-use='r' data-ref="DPB::va_pics">va_pics</a>[<a class="local col3 ref" href="#13i" title='i' data-ref="13i">i</a>]);</td></tr>
<tr><th id="136">136</th><td></td></tr>
<tr><th id="137">137</th><td>    <b>for</b> (<a class="local col3 ref" href="#13i" title='i' data-ref="13i">i</a> = <var>0</var>; <a class="local col3 ref" href="#13i" title='i' data-ref="13i">i</a> &lt; <a class="local col1 ref" href="#11h" title='h' data-ref="11h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::short_ref_count" title='H264Context::short_ref_count' data-ref="H264Context::short_ref_count">short_ref_count</a>; <a class="local col3 ref" href="#13i" title='i' data-ref="13i">i</a>++) {</td></tr>
<tr><th id="138">138</th><td>        <a class="typedef" href="h264dec.h.html#H264Picture" title='H264Picture' data-type='struct H264Picture' data-ref="H264Picture">H264Picture</a> * <em>const</em> <dfn class="local col4 decl" id="14pic" title='pic' data-type='H264Picture *const' data-ref="14pic">pic</dfn> = <a class="local col1 ref" href="#11h" title='h' data-ref="11h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::short_ref" title='H264Context::short_ref' data-ref="H264Context::short_ref">short_ref</a>[<a class="local col3 ref" href="#13i" title='i' data-ref="13i">i</a>];</td></tr>
<tr><th id="139">139</th><td>        <b>if</b> (<a class="local col4 ref" href="#14pic" title='pic' data-ref="14pic">pic</a> &amp;&amp; <a class="local col4 ref" href="#14pic" title='pic' data-ref="14pic">pic</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::reference" title='H264Picture::reference' data-ref="H264Picture::reference">reference</a> &amp;&amp; <a class="tu ref" href="#dpb_add" title='dpb_add' data-use='c' data-ref="dpb_add">dpb_add</a>(&amp;<a class="local col2 ref" href="#12dpb" title='dpb' data-ref="12dpb">dpb</a>, <a class="local col4 ref" href="#14pic" title='pic' data-ref="14pic">pic</a>) &lt; <var>0</var>)</td></tr>
<tr><th id="140">140</th><td>            <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="141">141</th><td>    }</td></tr>
<tr><th id="142">142</th><td></td></tr>
<tr><th id="143">143</th><td>    <b>for</b> (<a class="local col3 ref" href="#13i" title='i' data-ref="13i">i</a> = <var>0</var>; <a class="local col3 ref" href="#13i" title='i' data-ref="13i">i</a> &lt; <var>16</var>; <a class="local col3 ref" href="#13i" title='i' data-ref="13i">i</a>++) {</td></tr>
<tr><th id="144">144</th><td>        <a class="typedef" href="h264dec.h.html#H264Picture" title='H264Picture' data-type='struct H264Picture' data-ref="H264Picture">H264Picture</a> * <em>const</em> <dfn class="local col5 decl" id="15pic" title='pic' data-type='H264Picture *const' data-ref="15pic">pic</dfn> = <a class="local col1 ref" href="#11h" title='h' data-ref="11h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::long_ref" title='H264Context::long_ref' data-ref="H264Context::long_ref">long_ref</a>[<a class="local col3 ref" href="#13i" title='i' data-ref="13i">i</a>];</td></tr>
<tr><th id="145">145</th><td>        <b>if</b> (<a class="local col5 ref" href="#15pic" title='pic' data-ref="15pic">pic</a> &amp;&amp; <a class="local col5 ref" href="#15pic" title='pic' data-ref="15pic">pic</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::reference" title='H264Picture::reference' data-ref="H264Picture::reference">reference</a> &amp;&amp; <a class="tu ref" href="#dpb_add" title='dpb_add' data-use='c' data-ref="dpb_add">dpb_add</a>(&amp;<a class="local col2 ref" href="#12dpb" title='dpb' data-ref="12dpb">dpb</a>, <a class="local col5 ref" href="#15pic" title='pic' data-ref="15pic">pic</a>) &lt; <var>0</var>)</td></tr>
<tr><th id="146">146</th><td>            <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="147">147</th><td>    }</td></tr>
<tr><th id="148">148</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="149">149</th><td>}</td></tr>
<tr><th id="150">150</th><td></td></tr>
<tr><th id="151">151</th><td><i class="doc" data-doc="fill_vaapi_RefPicList">/**</i></td></tr>
<tr><th id="152">152</th><td><i class="doc" data-doc="fill_vaapi_RefPicList"> * Fill in VA API reference picture lists from the FFmpeg reference</i></td></tr>
<tr><th id="153">153</th><td><i class="doc" data-doc="fill_vaapi_RefPicList"> * picture list.</i></td></tr>
<tr><th id="154">154</th><td><i class="doc" data-doc="fill_vaapi_RefPicList"> *</i></td></tr>
<tr><th id="155">155</th><td><i class="doc" data-doc="fill_vaapi_RefPicList"> * <span class="command">@param</span>[out] <span class="arg">RefPicList</span>  VA API internal reference picture list</i></td></tr>
<tr><th id="156">156</th><td><i class="doc" data-doc="fill_vaapi_RefPicList"> * <span class="command">@param</span>[in]  <span class="arg">ref_list</span>    A pointer to the FFmpeg reference list</i></td></tr>
<tr><th id="157">157</th><td><i class="doc" data-doc="fill_vaapi_RefPicList"> * <span class="command">@param</span>[in]  <span class="arg">ref_count</span>   The number of reference pictures in ref_list</i></td></tr>
<tr><th id="158">158</th><td><i class="doc" data-doc="fill_vaapi_RefPicList"> */</i></td></tr>
<tr><th id="159">159</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="fill_vaapi_RefPicList" title='fill_vaapi_RefPicList' data-type='void fill_vaapi_RefPicList(VAPictureH264 * RefPicList, H264Ref * ref_list, unsigned int ref_count)' data-ref="fill_vaapi_RefPicList">fill_vaapi_RefPicList</dfn>(<a class="typedef" href="../../include/va/va.h.html#VAPictureH264" title='VAPictureH264' data-type='struct _VAPictureH264' data-ref="VAPictureH264">VAPictureH264</a> <dfn class="local col6 decl" id="16RefPicList" title='RefPicList' data-type='VAPictureH264 *' data-ref="16RefPicList">RefPicList</dfn>[<var>32</var>],</td></tr>
<tr><th id="160">160</th><td>                                  <a class="typedef" href="h264dec.h.html#H264Ref" title='H264Ref' data-type='struct H264Ref' data-ref="H264Ref">H264Ref</a>  *<dfn class="local col7 decl" id="17ref_list" title='ref_list' data-type='H264Ref *' data-ref="17ref_list">ref_list</dfn>,</td></tr>
<tr><th id="161">161</th><td>                                  <em>unsigned</em> <em>int</em>  <dfn class="local col8 decl" id="18ref_count" title='ref_count' data-type='unsigned int' data-ref="18ref_count">ref_count</dfn>)</td></tr>
<tr><th id="162">162</th><td>{</td></tr>
<tr><th id="163">163</th><td>    <em>unsigned</em> <em>int</em> <dfn class="local col9 decl" id="19i" title='i' data-type='unsigned int' data-ref="19i">i</dfn>, <dfn class="local col0 decl" id="20n" title='n' data-type='unsigned int' data-ref="20n">n</dfn> = <var>0</var>;</td></tr>
<tr><th id="164">164</th><td>    <b>for</b> (<a class="local col9 ref" href="#19i" title='i' data-ref="19i">i</a> = <var>0</var>; <a class="local col9 ref" href="#19i" title='i' data-ref="19i">i</a> &lt; <a class="local col8 ref" href="#18ref_count" title='ref_count' data-ref="18ref_count">ref_count</a>; <a class="local col9 ref" href="#19i" title='i' data-ref="19i">i</a>++)</td></tr>
<tr><th id="165">165</th><td>        <b>if</b> (<a class="local col7 ref" href="#17ref_list" title='ref_list' data-ref="17ref_list">ref_list</a>[<a class="local col9 ref" href="#19i" title='i' data-ref="19i">i</a>].<a class="ref" href="h264dec.h.html#H264Ref::reference" title='H264Ref::reference' data-ref="H264Ref::reference">reference</a>)</td></tr>
<tr><th id="166">166</th><td>            <a class="tu ref" href="#fill_vaapi_pic" title='fill_vaapi_pic' data-use='c' data-ref="fill_vaapi_pic">fill_vaapi_pic</a>(&amp;<a class="local col6 ref" href="#16RefPicList" title='RefPicList' data-ref="16RefPicList">RefPicList</a>[<a class="local col0 ref" href="#20n" title='n' data-ref="20n">n</a>++], <a class="local col7 ref" href="#17ref_list" title='ref_list' data-ref="17ref_list">ref_list</a>[<a class="local col9 ref" href="#19i" title='i' data-ref="19i">i</a>].<a class="ref" href="h264dec.h.html#H264Ref::parent" title='H264Ref::parent' data-ref="H264Ref::parent">parent</a>,</td></tr>
<tr><th id="167">167</th><td>                           <a class="local col7 ref" href="#17ref_list" title='ref_list' data-ref="17ref_list">ref_list</a>[<a class="local col9 ref" href="#19i" title='i' data-ref="19i">i</a>].<a class="ref" href="h264dec.h.html#H264Ref::reference" title='H264Ref::reference' data-ref="H264Ref::reference">reference</a>);</td></tr>
<tr><th id="168">168</th><td></td></tr>
<tr><th id="169">169</th><td>    <b>for</b> (; <a class="local col0 ref" href="#20n" title='n' data-ref="20n">n</a> &lt; <var>32</var>; <a class="local col0 ref" href="#20n" title='n' data-ref="20n">n</a>++)</td></tr>
<tr><th id="170">170</th><td>        <a class="tu ref" href="#init_vaapi_pic" title='init_vaapi_pic' data-use='c' data-ref="init_vaapi_pic">init_vaapi_pic</a>(&amp;<a class="local col6 ref" href="#16RefPicList" title='RefPicList' data-ref="16RefPicList">RefPicList</a>[<a class="local col0 ref" href="#20n" title='n' data-ref="20n">n</a>]);</td></tr>
<tr><th id="171">171</th><td>}</td></tr>
<tr><th id="172">172</th><td></td></tr>
<tr><th id="173">173</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table">/**</i></td></tr>
<tr><th id="174">174</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table"> * Fill in prediction weight table.</i></td></tr>
<tr><th id="175">175</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table"> *</i></td></tr>
<tr><th id="176">176</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table"> * VA API requires a plain prediction weight table as it does not infer</i></td></tr>
<tr><th id="177">177</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table"> * any value.</i></td></tr>
<tr><th id="178">178</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table"> *</i></td></tr>
<tr><th id="179">179</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table"> * <span class="command">@param</span>[in]  <span class="arg">h</span>                   A pointer to the current H.264 context</i></td></tr>
<tr><th id="180">180</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table"> * <span class="command">@param</span>[in]  <span class="arg">list</span>                The reference frame list index to use</i></td></tr>
<tr><th id="181">181</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table"> * <span class="command">@param</span>[out] <span class="arg">luma_weight_flag</span>    VA API plain luma weight flag</i></td></tr>
<tr><th id="182">182</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table"> * <span class="command">@param</span>[out] <span class="arg">luma_weight</span>         VA API plain luma weight table</i></td></tr>
<tr><th id="183">183</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table"> * <span class="command">@param</span>[out] <span class="arg">luma_offset</span>         VA API plain luma offset table</i></td></tr>
<tr><th id="184">184</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table"> * <span class="command">@param</span>[out] <span class="arg">chroma_weight_flag</span>  VA API plain chroma weight flag</i></td></tr>
<tr><th id="185">185</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table"> * <span class="command">@param</span>[out] <span class="arg">chroma_weight</span>       VA API plain chroma weight table</i></td></tr>
<tr><th id="186">186</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table"> * <span class="command">@param</span>[out] <span class="arg">chroma_offset</span>       VA API plain chroma offset table</i></td></tr>
<tr><th id="187">187</th><td><i class="doc" data-doc="fill_vaapi_plain_pred_weight_table"> */</i></td></tr>
<tr><th id="188">188</th><td><em>static</em> <em>void</em> <dfn class="tu decl def" id="fill_vaapi_plain_pred_weight_table" title='fill_vaapi_plain_pred_weight_table' data-type='void fill_vaapi_plain_pred_weight_table(H264Context * h, int list, unsigned char * luma_weight_flag, short * luma_weight, short * luma_offset, unsigned char * chroma_weight_flag, short (*)[2] chroma_weight, short (*)[2] chroma_offset)' data-ref="fill_vaapi_plain_pred_weight_table">fill_vaapi_plain_pred_weight_table</dfn>(<a class="typedef" href="h264dec.h.html#H264Context" title='H264Context' data-type='struct H264Context' data-ref="H264Context">H264Context</a>   *<dfn class="local col1 decl" id="21h" title='h' data-type='H264Context *' data-ref="21h">h</dfn>,</td></tr>
<tr><th id="189">189</th><td>                                               <em>int</em>            <dfn class="local col2 decl" id="22list" title='list' data-type='int' data-ref="22list">list</dfn>,</td></tr>
<tr><th id="190">190</th><td>                                               <em>unsigned</em> <em>char</em> *<dfn class="local col3 decl" id="23luma_weight_flag" title='luma_weight_flag' data-type='unsigned char *' data-ref="23luma_weight_flag">luma_weight_flag</dfn>,</td></tr>
<tr><th id="191">191</th><td>                                               <em>short</em>          <dfn class="local col4 decl" id="24luma_weight" title='luma_weight' data-type='short *' data-ref="24luma_weight">luma_weight</dfn>[<var>32</var>],</td></tr>
<tr><th id="192">192</th><td>                                               <em>short</em>          <dfn class="local col5 decl" id="25luma_offset" title='luma_offset' data-type='short *' data-ref="25luma_offset">luma_offset</dfn>[<var>32</var>],</td></tr>
<tr><th id="193">193</th><td>                                               <em>unsigned</em> <em>char</em> *<dfn class="local col6 decl" id="26chroma_weight_flag" title='chroma_weight_flag' data-type='unsigned char *' data-ref="26chroma_weight_flag">chroma_weight_flag</dfn>,</td></tr>
<tr><th id="194">194</th><td>                                               <em>short</em>          <dfn class="local col7 decl" id="27chroma_weight" title='chroma_weight' data-type='short (*)[2]' data-ref="27chroma_weight">chroma_weight</dfn>[<var>32</var>][<var>2</var>],</td></tr>
<tr><th id="195">195</th><td>                                               <em>short</em>          <dfn class="local col8 decl" id="28chroma_offset" title='chroma_offset' data-type='short (*)[2]' data-ref="28chroma_offset">chroma_offset</dfn>[<var>32</var>][<var>2</var>])</td></tr>
<tr><th id="196">196</th><td>{</td></tr>
<tr><th id="197">197</th><td>    <a class="typedef" href="h264dec.h.html#H264SliceContext" title='H264SliceContext' data-type='struct H264SliceContext' data-ref="H264SliceContext">H264SliceContext</a> *<dfn class="local col9 decl" id="29sl" title='sl' data-type='H264SliceContext *' data-ref="29sl">sl</dfn> = &amp;<a class="local col1 ref" href="#21h" title='h' data-ref="21h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::slice_ctx" title='H264Context::slice_ctx' data-ref="H264Context::slice_ctx">slice_ctx</a>[<var>0</var>];</td></tr>
<tr><th id="198">198</th><td>    <em>unsigned</em> <em>int</em> <dfn class="local col0 decl" id="30i" title='i' data-type='unsigned int' data-ref="30i">i</dfn>, <dfn class="local col1 decl" id="31j" title='j' data-type='unsigned int' data-ref="31j">j</dfn>;</td></tr>
<tr><th id="199">199</th><td></td></tr>
<tr><th id="200">200</th><td>    *<a class="local col3 ref" href="#23luma_weight_flag" title='luma_weight_flag' data-ref="23luma_weight_flag">luma_weight_flag</a>    = <a class="local col9 ref" href="#29sl" title='sl' data-ref="29sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::pwt" title='H264SliceContext::pwt' data-ref="H264SliceContext::pwt">pwt</a>.<a class="ref" href="h264_parse.h.html#H264PredWeightTable::luma_weight_flag" title='H264PredWeightTable::luma_weight_flag' data-ref="H264PredWeightTable::luma_weight_flag">luma_weight_flag</a>[<a class="local col2 ref" href="#22list" title='list' data-ref="22list">list</a>];</td></tr>
<tr><th id="201">201</th><td>    *<a class="local col6 ref" href="#26chroma_weight_flag" title='chroma_weight_flag' data-ref="26chroma_weight_flag">chroma_weight_flag</a>  = <a class="local col9 ref" href="#29sl" title='sl' data-ref="29sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::pwt" title='H264SliceContext::pwt' data-ref="H264SliceContext::pwt">pwt</a>.<a class="ref" href="h264_parse.h.html#H264PredWeightTable::chroma_weight_flag" title='H264PredWeightTable::chroma_weight_flag' data-ref="H264PredWeightTable::chroma_weight_flag">chroma_weight_flag</a>[<a class="local col2 ref" href="#22list" title='list' data-ref="22list">list</a>];</td></tr>
<tr><th id="202">202</th><td></td></tr>
<tr><th id="203">203</th><td>    <b>for</b> (<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a> = <var>0</var>; <a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a> &lt; <a class="local col9 ref" href="#29sl" title='sl' data-ref="29sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::ref_count" title='H264SliceContext::ref_count' data-ref="H264SliceContext::ref_count">ref_count</a>[<a class="local col2 ref" href="#22list" title='list' data-ref="22list">list</a>]; <a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>++) {</td></tr>
<tr><th id="204">204</th><td>        <i>/* VA API also wants the inferred (default) values, not</i></td></tr>
<tr><th id="205">205</th><td><i>           only what is available in the bitstream (7.4.3.2). */</i></td></tr>
<tr><th id="206">206</th><td>        <b>if</b> (<a class="local col9 ref" href="#29sl" title='sl' data-ref="29sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::pwt" title='H264SliceContext::pwt' data-ref="H264SliceContext::pwt">pwt</a>.<a class="ref" href="h264_parse.h.html#H264PredWeightTable::luma_weight_flag" title='H264PredWeightTable::luma_weight_flag' data-ref="H264PredWeightTable::luma_weight_flag">luma_weight_flag</a>[<a class="local col2 ref" href="#22list" title='list' data-ref="22list">list</a>]) {</td></tr>
<tr><th id="207">207</th><td>            <a class="local col4 ref" href="#24luma_weight" title='luma_weight' data-ref="24luma_weight">luma_weight</a>[<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>] = <a class="local col9 ref" href="#29sl" title='sl' data-ref="29sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::pwt" title='H264SliceContext::pwt' data-ref="H264SliceContext::pwt">pwt</a>.<a class="ref" href="h264_parse.h.html#H264PredWeightTable::luma_weight" title='H264PredWeightTable::luma_weight' data-ref="H264PredWeightTable::luma_weight">luma_weight</a>[<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>][<a class="local col2 ref" href="#22list" title='list' data-ref="22list">list</a>][<var>0</var>];</td></tr>
<tr><th id="208">208</th><td>            <a class="local col5 ref" href="#25luma_offset" title='luma_offset' data-ref="25luma_offset">luma_offset</a>[<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>] = <a class="local col9 ref" href="#29sl" title='sl' data-ref="29sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::pwt" title='H264SliceContext::pwt' data-ref="H264SliceContext::pwt">pwt</a>.<a class="ref" href="h264_parse.h.html#H264PredWeightTable::luma_weight" title='H264PredWeightTable::luma_weight' data-ref="H264PredWeightTable::luma_weight">luma_weight</a>[<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>][<a class="local col2 ref" href="#22list" title='list' data-ref="22list">list</a>][<var>1</var>];</td></tr>
<tr><th id="209">209</th><td>        } <b>else</b> {</td></tr>
<tr><th id="210">210</th><td>            <a class="local col4 ref" href="#24luma_weight" title='luma_weight' data-ref="24luma_weight">luma_weight</a>[<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>] = <var>1</var> &lt;&lt; <a class="local col9 ref" href="#29sl" title='sl' data-ref="29sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::pwt" title='H264SliceContext::pwt' data-ref="H264SliceContext::pwt">pwt</a>.<a class="ref" href="h264_parse.h.html#H264PredWeightTable::luma_log2_weight_denom" title='H264PredWeightTable::luma_log2_weight_denom' data-ref="H264PredWeightTable::luma_log2_weight_denom">luma_log2_weight_denom</a>;</td></tr>
<tr><th id="211">211</th><td>            <a class="local col5 ref" href="#25luma_offset" title='luma_offset' data-ref="25luma_offset">luma_offset</a>[<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>] = <var>0</var>;</td></tr>
<tr><th id="212">212</th><td>        }</td></tr>
<tr><th id="213">213</th><td>        <b>for</b> (<a class="local col1 ref" href="#31j" title='j' data-ref="31j">j</a> = <var>0</var>; <a class="local col1 ref" href="#31j" title='j' data-ref="31j">j</a> &lt; <var>2</var>; <a class="local col1 ref" href="#31j" title='j' data-ref="31j">j</a>++) {</td></tr>
<tr><th id="214">214</th><td>            <b>if</b> (<a class="local col9 ref" href="#29sl" title='sl' data-ref="29sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::pwt" title='H264SliceContext::pwt' data-ref="H264SliceContext::pwt">pwt</a>.<a class="ref" href="h264_parse.h.html#H264PredWeightTable::chroma_weight_flag" title='H264PredWeightTable::chroma_weight_flag' data-ref="H264PredWeightTable::chroma_weight_flag">chroma_weight_flag</a>[<a class="local col2 ref" href="#22list" title='list' data-ref="22list">list</a>]) {</td></tr>
<tr><th id="215">215</th><td>                <a class="local col7 ref" href="#27chroma_weight" title='chroma_weight' data-ref="27chroma_weight">chroma_weight</a>[<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>][<a class="local col1 ref" href="#31j" title='j' data-ref="31j">j</a>] = <a class="local col9 ref" href="#29sl" title='sl' data-ref="29sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::pwt" title='H264SliceContext::pwt' data-ref="H264SliceContext::pwt">pwt</a>.<a class="ref" href="h264_parse.h.html#H264PredWeightTable::chroma_weight" title='H264PredWeightTable::chroma_weight' data-ref="H264PredWeightTable::chroma_weight">chroma_weight</a>[<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>][<a class="local col2 ref" href="#22list" title='list' data-ref="22list">list</a>][<a class="local col1 ref" href="#31j" title='j' data-ref="31j">j</a>][<var>0</var>];</td></tr>
<tr><th id="216">216</th><td>                <a class="local col8 ref" href="#28chroma_offset" title='chroma_offset' data-ref="28chroma_offset">chroma_offset</a>[<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>][<a class="local col1 ref" href="#31j" title='j' data-ref="31j">j</a>] = <a class="local col9 ref" href="#29sl" title='sl' data-ref="29sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::pwt" title='H264SliceContext::pwt' data-ref="H264SliceContext::pwt">pwt</a>.<a class="ref" href="h264_parse.h.html#H264PredWeightTable::chroma_weight" title='H264PredWeightTable::chroma_weight' data-ref="H264PredWeightTable::chroma_weight">chroma_weight</a>[<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>][<a class="local col2 ref" href="#22list" title='list' data-ref="22list">list</a>][<a class="local col1 ref" href="#31j" title='j' data-ref="31j">j</a>][<var>1</var>];</td></tr>
<tr><th id="217">217</th><td>            } <b>else</b> {</td></tr>
<tr><th id="218">218</th><td>                <a class="local col7 ref" href="#27chroma_weight" title='chroma_weight' data-ref="27chroma_weight">chroma_weight</a>[<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>][<a class="local col1 ref" href="#31j" title='j' data-ref="31j">j</a>] = <var>1</var> &lt;&lt; <a class="local col9 ref" href="#29sl" title='sl' data-ref="29sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::pwt" title='H264SliceContext::pwt' data-ref="H264SliceContext::pwt">pwt</a>.<a class="ref" href="h264_parse.h.html#H264PredWeightTable::chroma_log2_weight_denom" title='H264PredWeightTable::chroma_log2_weight_denom' data-ref="H264PredWeightTable::chroma_log2_weight_denom">chroma_log2_weight_denom</a>;</td></tr>
<tr><th id="219">219</th><td>                <a class="local col8 ref" href="#28chroma_offset" title='chroma_offset' data-ref="28chroma_offset">chroma_offset</a>[<a class="local col0 ref" href="#30i" title='i' data-ref="30i">i</a>][<a class="local col1 ref" href="#31j" title='j' data-ref="31j">j</a>] = <var>0</var>;</td></tr>
<tr><th id="220">220</th><td>            }</td></tr>
<tr><th id="221">221</th><td>        }</td></tr>
<tr><th id="222">222</th><td>    }</td></tr>
<tr><th id="223">223</th><td>}</td></tr>
<tr><th id="224">224</th><td></td></tr>
<tr><th id="225">225</th><td><i class="doc" data-doc="vaapi_h264_start_frame">/** Initialize and start decoding a frame with VA API. */</i></td></tr>
<tr><th id="226">226</th><td><em>static</em> <em>int</em> <dfn class="tu decl def" id="vaapi_h264_start_frame" title='vaapi_h264_start_frame' data-type='int vaapi_h264_start_frame(AVCodecContext * avctx, const uint8_t * buffer, uint32_t size)' data-ref="vaapi_h264_start_frame">vaapi_h264_start_frame</dfn>(<a class="typedef" href="avcodec.h.html#AVCodecContext" title='AVCodecContext' data-type='struct AVCodecContext' data-ref="AVCodecContext">AVCodecContext</a>          *<dfn class="local col2 decl" id="32avctx" title='avctx' data-type='AVCodecContext *' data-ref="32avctx">avctx</dfn>,</td></tr>
<tr><th id="227">227</th><td>                                  <a class="macro" href="../libavutil/attributes.h.html#126" title="__attribute__((unused))" data-ref="_M/av_unused">av_unused</a> <em>const</em> <a class="typedef" href="../../include/stdint.h.html#uint8_t" title='uint8_t' data-type='unsigned char' data-ref="uint8_t">uint8_t</a> *<dfn class="local col3 decl" id="33buffer" title='buffer' data-type='const uint8_t *' data-ref="33buffer">buffer</dfn>,</td></tr>
<tr><th id="228">228</th><td>                                  <a class="macro" href="../libavutil/attributes.h.html#126" title="__attribute__((unused))" data-ref="_M/av_unused">av_unused</a> <a class="typedef" href="../../include/stdint.h.html#uint32_t" title='uint32_t' data-type='unsigned int' data-ref="uint32_t">uint32_t</a>       <dfn class="local col4 decl" id="34size" title='size' data-type='uint32_t' data-ref="34size">size</dfn>)</td></tr>
<tr><th id="229">229</th><td>{</td></tr>
<tr><th id="230">230</th><td>    <a class="typedef" href="h264dec.h.html#H264Context" title='H264Context' data-type='struct H264Context' data-ref="H264Context">H264Context</a> * <em>const</em> <dfn class="local col5 decl" id="35h" title='h' data-type='H264Context *const' data-ref="35h">h</dfn> = <a class="local col2 ref" href="#32avctx" title='avctx' data-ref="32avctx">avctx</a>-&gt;<a class="ref" href="avcodec.h.html#AVCodecContext::priv_data" title='AVCodecContext::priv_data' data-ref="AVCodecContext::priv_data">priv_data</a>;</td></tr>
<tr><th id="231">231</th><td>    <a class="typedef" href="vaapi_internal.h.html#FFVAContext" title='FFVAContext' data-type='struct FFVAContext' data-ref="FFVAContext">FFVAContext</a> * <em>const</em> <dfn class="local col6 decl" id="36vactx" title='vactx' data-type='FFVAContext *const' data-ref="36vactx">vactx</dfn> = <a class="ref" href="vaapi_internal.h.html#ff_vaapi_get_context" title='ff_vaapi_get_context' data-ref="ff_vaapi_get_context">ff_vaapi_get_context</a>(<a class="local col2 ref" href="#32avctx" title='avctx' data-ref="32avctx">avctx</a>);</td></tr>
<tr><th id="232">232</th><td>    <em>const</em> <a class="typedef" href="h264_ps.h.html#PPS" title='PPS' data-type='struct PPS' data-ref="PPS">PPS</a> *<dfn class="local col7 decl" id="37pps" title='pps' data-type='const PPS *' data-ref="37pps">pps</dfn> = <a class="local col5 ref" href="#35h" title='h' data-ref="35h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::ps" title='H264Context::ps' data-ref="H264Context::ps">ps</a>.<a class="ref" href="h264_ps.h.html#H264ParamSets::pps" title='H264ParamSets::pps' data-ref="H264ParamSets::pps">pps</a>;</td></tr>
<tr><th id="233">233</th><td>    <em>const</em> <a class="typedef" href="h264_ps.h.html#SPS" title='SPS' data-type='struct SPS' data-ref="SPS">SPS</a> *<dfn class="local col8 decl" id="38sps" title='sps' data-type='const SPS *' data-ref="38sps">sps</dfn> = <a class="local col5 ref" href="#35h" title='h' data-ref="35h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::ps" title='H264Context::ps' data-ref="H264Context::ps">ps</a>.<a class="ref" href="h264_ps.h.html#H264ParamSets::sps" title='H264ParamSets::sps' data-ref="H264ParamSets::sps">sps</a>;</td></tr>
<tr><th id="234">234</th><td>    <a class="typedef" href="../../include/va/va.h.html#VAPictureParameterBufferH264" title='VAPictureParameterBufferH264' data-type='struct _VAPictureParameterBufferH264' data-ref="VAPictureParameterBufferH264">VAPictureParameterBufferH264</a> *<dfn class="local col9 decl" id="39pic_param" title='pic_param' data-type='VAPictureParameterBufferH264 *' data-ref="39pic_param">pic_param</dfn>;</td></tr>
<tr><th id="235">235</th><td>    <a class="typedef" href="../../include/va/va.h.html#VAIQMatrixBufferH264" title='VAIQMatrixBufferH264' data-type='struct _VAIQMatrixBufferH264' data-ref="VAIQMatrixBufferH264">VAIQMatrixBufferH264</a> *<dfn class="local col0 decl" id="40iq_matrix" title='iq_matrix' data-type='VAIQMatrixBufferH264 *' data-ref="40iq_matrix">iq_matrix</dfn>;</td></tr>
<tr><th id="236">236</th><td></td></tr>
<tr><th id="237">237</th><td>    <a class="local col6 ref" href="#36vactx" title='vactx' data-ref="36vactx">vactx</a>-&gt;<a class="ref" href="vaapi_internal.h.html#{anonymous}::slice_param_size" title='&lt;anonymous struct&gt;::slice_param_size' data-ref="{anonymous}::slice_param_size">slice_param_size</a> = <b>sizeof</b>(<a class="typedef" href="../../include/va/va.h.html#VASliceParameterBufferH264" title='VASliceParameterBufferH264' data-type='struct _VASliceParameterBufferH264' data-ref="VASliceParameterBufferH264">VASliceParameterBufferH264</a>);</td></tr>
<tr><th id="238">238</th><td></td></tr>
<tr><th id="239">239</th><td>    <i>/* Fill in VAPictureParameterBufferH264. */</i></td></tr>
<tr><th id="240">240</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a> = <a class="ref" href="vaapi_internal.h.html#ff_vaapi_alloc_pic_param" title='ff_vaapi_alloc_pic_param' data-ref="ff_vaapi_alloc_pic_param">ff_vaapi_alloc_pic_param</a>(<a class="local col6 ref" href="#36vactx" title='vactx' data-ref="36vactx">vactx</a>, <b>sizeof</b>(<a class="typedef" href="../../include/va/va.h.html#VAPictureParameterBufferH264" title='VAPictureParameterBufferH264' data-type='struct _VAPictureParameterBufferH264' data-ref="VAPictureParameterBufferH264">VAPictureParameterBufferH264</a>));</td></tr>
<tr><th id="241">241</th><td>    <b>if</b> (!<a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>)</td></tr>
<tr><th id="242">242</th><td>        <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="243">243</th><td>    <a class="tu ref" href="#fill_vaapi_pic" title='fill_vaapi_pic' data-use='c' data-ref="fill_vaapi_pic">fill_vaapi_pic</a>(&amp;<a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::CurrPic" title='_VAPictureParameterBufferH264::CurrPic' data-ref="_VAPictureParameterBufferH264::CurrPic">CurrPic</a>, <a class="local col5 ref" href="#35h" title='h' data-ref="35h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::cur_pic_ptr" title='H264Context::cur_pic_ptr' data-ref="H264Context::cur_pic_ptr">cur_pic_ptr</a>, <a class="local col5 ref" href="#35h" title='h' data-ref="35h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::picture_structure" title='H264Context::picture_structure' data-ref="H264Context::picture_structure">picture_structure</a>);</td></tr>
<tr><th id="244">244</th><td>    <b>if</b> (<a class="tu ref" href="#fill_vaapi_ReferenceFrames" title='fill_vaapi_ReferenceFrames' data-use='c' data-ref="fill_vaapi_ReferenceFrames">fill_vaapi_ReferenceFrames</a>(<a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>, <a class="local col5 ref" href="#35h" title='h' data-ref="35h">h</a>) &lt; <var>0</var>)</td></tr>
<tr><th id="245">245</th><td>        <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="246">246</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::picture_width_in_mbs_minus1" title='_VAPictureParameterBufferH264::picture_width_in_mbs_minus1' data-ref="_VAPictureParameterBufferH264::picture_width_in_mbs_minus1">picture_width_in_mbs_minus1</a>                      = <a class="local col5 ref" href="#35h" title='h' data-ref="35h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::mb_width" title='H264Context::mb_width' data-ref="H264Context::mb_width">mb_width</a> - <var>1</var>;</td></tr>
<tr><th id="247">247</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::picture_height_in_mbs_minus1" title='_VAPictureParameterBufferH264::picture_height_in_mbs_minus1' data-ref="_VAPictureParameterBufferH264::picture_height_in_mbs_minus1">picture_height_in_mbs_minus1</a>                     = <a class="local col5 ref" href="#35h" title='h' data-ref="35h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::mb_height" title='H264Context::mb_height' data-ref="H264Context::mb_height">mb_height</a> - <var>1</var>;</td></tr>
<tr><th id="248">248</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::bit_depth_luma_minus8" title='_VAPictureParameterBufferH264::bit_depth_luma_minus8' data-ref="_VAPictureParameterBufferH264::bit_depth_luma_minus8">bit_depth_luma_minus8</a>                            = <a class="local col8 ref" href="#38sps" title='sps' data-ref="38sps">sps</a>-&gt;<a class="ref" href="h264_ps.h.html#SPS::bit_depth_luma" title='SPS::bit_depth_luma' data-ref="SPS::bit_depth_luma">bit_depth_luma</a> - <var>8</var>;</td></tr>
<tr><th id="249">249</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::bit_depth_chroma_minus8" title='_VAPictureParameterBufferH264::bit_depth_chroma_minus8' data-ref="_VAPictureParameterBufferH264::bit_depth_chroma_minus8">bit_depth_chroma_minus8</a>                          = <a class="local col8 ref" href="#38sps" title='sps' data-ref="38sps">sps</a>-&gt;<a class="ref" href="h264_ps.h.html#SPS::bit_depth_chroma" title='SPS::bit_depth_chroma' data-ref="SPS::bit_depth_chroma">bit_depth_chroma</a> - <var>8</var>;</td></tr>
<tr><th id="250">250</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::num_ref_frames" title='_VAPictureParameterBufferH264::num_ref_frames' data-ref="_VAPictureParameterBufferH264::num_ref_frames">num_ref_frames</a>                                   = <a class="local col8 ref" href="#38sps" title='sps' data-ref="38sps">sps</a>-&gt;<a class="ref" href="h264_ps.h.html#SPS::ref_frame_count" title='SPS::ref_frame_count' data-ref="SPS::ref_frame_count">ref_frame_count</a>;</td></tr>
<tr><th id="251">251</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::seq_fields" title='_VAPictureParameterBufferH264::seq_fields' data-ref="_VAPictureParameterBufferH264::seq_fields">seq_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::value" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::value' data-ref="_VAPictureParameterBufferH264::{anonymous}::value">value</a>                                 = <var>0</var>; <i>/* reset all bits */</i></td></tr>
<tr><th id="252">252</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::seq_fields" title='_VAPictureParameterBufferH264::seq_fields' data-ref="_VAPictureParameterBufferH264::seq_fields">seq_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::chroma_format_idc" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::chroma_format_idc' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::chroma_format_idc">chroma_format_idc</a>                = <a class="local col8 ref" href="#38sps" title='sps' data-ref="38sps">sps</a>-&gt;<a class="ref" href="h264_ps.h.html#SPS::chroma_format_idc" title='SPS::chroma_format_idc' data-ref="SPS::chroma_format_idc">chroma_format_idc</a>;</td></tr>
<tr><th id="253">253</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::seq_fields" title='_VAPictureParameterBufferH264::seq_fields' data-ref="_VAPictureParameterBufferH264::seq_fields">seq_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::residual_colour_transform_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::residual_colour_transform_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::residual_colour_transform_flag">residual_colour_transform_flag</a>   = <a class="local col8 ref" href="#38sps" title='sps' data-ref="38sps">sps</a>-&gt;<a class="ref" href="h264_ps.h.html#SPS::residual_color_transform_flag" title='SPS::residual_color_transform_flag' data-ref="SPS::residual_color_transform_flag">residual_color_transform_flag</a>; <i>/* XXX: only for 4:4:4 high profile? */</i></td></tr>
<tr><th id="254">254</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::seq_fields" title='_VAPictureParameterBufferH264::seq_fields' data-ref="_VAPictureParameterBufferH264::seq_fields">seq_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::gaps_in_frame_num_value_allowed_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::gaps_in_frame_num_value_allowed_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::gaps_in_frame_num_value_allowed_flag">gaps_in_frame_num_value_allowed_flag</a> = <a class="local col8 ref" href="#38sps" title='sps' data-ref="38sps">sps</a>-&gt;<a class="ref" href="h264_ps.h.html#SPS::gaps_in_frame_num_allowed_flag" title='SPS::gaps_in_frame_num_allowed_flag' data-ref="SPS::gaps_in_frame_num_allowed_flag">gaps_in_frame_num_allowed_flag</a>;</td></tr>
<tr><th id="255">255</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::seq_fields" title='_VAPictureParameterBufferH264::seq_fields' data-ref="_VAPictureParameterBufferH264::seq_fields">seq_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::frame_mbs_only_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::frame_mbs_only_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::frame_mbs_only_flag">frame_mbs_only_flag</a>              = <a class="local col8 ref" href="#38sps" title='sps' data-ref="38sps">sps</a>-&gt;<a class="ref" href="h264_ps.h.html#SPS::frame_mbs_only_flag" title='SPS::frame_mbs_only_flag' data-ref="SPS::frame_mbs_only_flag">frame_mbs_only_flag</a>;</td></tr>
<tr><th id="256">256</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::seq_fields" title='_VAPictureParameterBufferH264::seq_fields' data-ref="_VAPictureParameterBufferH264::seq_fields">seq_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::mb_adaptive_frame_field_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::mb_adaptive_frame_field_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::mb_adaptive_frame_field_flag">mb_adaptive_frame_field_flag</a>     = <a class="local col8 ref" href="#38sps" title='sps' data-ref="38sps">sps</a>-&gt;<a class="ref" href="h264_ps.h.html#SPS::mb_aff" title='SPS::mb_aff' data-ref="SPS::mb_aff">mb_aff</a>;</td></tr>
<tr><th id="257">257</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::seq_fields" title='_VAPictureParameterBufferH264::seq_fields' data-ref="_VAPictureParameterBufferH264::seq_fields">seq_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::direct_8x8_inference_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::direct_8x8_inference_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::direct_8x8_inference_flag">direct_8x8_inference_flag</a>        = <a class="local col8 ref" href="#38sps" title='sps' data-ref="38sps">sps</a>-&gt;<a class="ref" href="h264_ps.h.html#SPS::direct_8x8_inference_flag" title='SPS::direct_8x8_inference_flag' data-ref="SPS::direct_8x8_inference_flag">direct_8x8_inference_flag</a>;</td></tr>
<tr><th id="258">258</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::seq_fields" title='_VAPictureParameterBufferH264::seq_fields' data-ref="_VAPictureParameterBufferH264::seq_fields">seq_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::MinLumaBiPredSize8x8" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::MinLumaBiPredSize8x8' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::MinLumaBiPredSize8x8">MinLumaBiPredSize8x8</a>             = <a class="local col8 ref" href="#38sps" title='sps' data-ref="38sps">sps</a>-&gt;<a class="ref" href="h264_ps.h.html#SPS::level_idc" title='SPS::level_idc' data-ref="SPS::level_idc">level_idc</a> &gt;= <var>31</var>; <i>/* A.3.3.2 */</i></td></tr>
<tr><th id="259">259</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::seq_fields" title='_VAPictureParameterBufferH264::seq_fields' data-ref="_VAPictureParameterBufferH264::seq_fields">seq_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::log2_max_frame_num_minus4" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::log2_max_frame_num_minus4' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::log2_max_frame_num_minus4">log2_max_frame_num_minus4</a>        = <a class="local col8 ref" href="#38sps" title='sps' data-ref="38sps">sps</a>-&gt;<a class="ref" href="h264_ps.h.html#SPS::log2_max_frame_num" title='SPS::log2_max_frame_num' data-ref="SPS::log2_max_frame_num">log2_max_frame_num</a> - <var>4</var>;</td></tr>
<tr><th id="260">260</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::seq_fields" title='_VAPictureParameterBufferH264::seq_fields' data-ref="_VAPictureParameterBufferH264::seq_fields">seq_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::pic_order_cnt_type" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::pic_order_cnt_type' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::pic_order_cnt_type">pic_order_cnt_type</a>               = <a class="local col8 ref" href="#38sps" title='sps' data-ref="38sps">sps</a>-&gt;<a class="ref" href="h264_ps.h.html#SPS::poc_type" title='SPS::poc_type' data-ref="SPS::poc_type">poc_type</a>;</td></tr>
<tr><th id="261">261</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::seq_fields" title='_VAPictureParameterBufferH264::seq_fields' data-ref="_VAPictureParameterBufferH264::seq_fields">seq_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::log2_max_pic_order_cnt_lsb_minus4" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::log2_max_pic_order_cnt_lsb_minus4' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::log2_max_pic_order_cnt_lsb_minus4">log2_max_pic_order_cnt_lsb_minus4</a> = <a class="local col8 ref" href="#38sps" title='sps' data-ref="38sps">sps</a>-&gt;<a class="ref" href="h264_ps.h.html#SPS::log2_max_poc_lsb" title='SPS::log2_max_poc_lsb' data-ref="SPS::log2_max_poc_lsb">log2_max_poc_lsb</a> - <var>4</var>;</td></tr>
<tr><th id="262">262</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::seq_fields" title='_VAPictureParameterBufferH264::seq_fields' data-ref="_VAPictureParameterBufferH264::seq_fields">seq_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::delta_pic_order_always_zero_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::delta_pic_order_always_zero_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::delta_pic_order_always_zero_flag">delta_pic_order_always_zero_flag</a> = <a class="local col8 ref" href="#38sps" title='sps' data-ref="38sps">sps</a>-&gt;<a class="ref" href="h264_ps.h.html#SPS::delta_pic_order_always_zero_flag" title='SPS::delta_pic_order_always_zero_flag' data-ref="SPS::delta_pic_order_always_zero_flag">delta_pic_order_always_zero_flag</a>;</td></tr>
<tr><th id="263">263</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::num_slice_groups_minus1" title='_VAPictureParameterBufferH264::num_slice_groups_minus1' data-ref="_VAPictureParameterBufferH264::num_slice_groups_minus1">num_slice_groups_minus1</a>                          = <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::slice_group_count" title='PPS::slice_group_count' data-ref="PPS::slice_group_count">slice_group_count</a> - <var>1</var>;</td></tr>
<tr><th id="264">264</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::slice_group_map_type" title='_VAPictureParameterBufferH264::slice_group_map_type' data-ref="_VAPictureParameterBufferH264::slice_group_map_type">slice_group_map_type</a>                             = <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::mb_slice_group_map_type" title='PPS::mb_slice_group_map_type' data-ref="PPS::mb_slice_group_map_type">mb_slice_group_map_type</a>;</td></tr>
<tr><th id="265">265</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::slice_group_change_rate_minus1" title='_VAPictureParameterBufferH264::slice_group_change_rate_minus1' data-ref="_VAPictureParameterBufferH264::slice_group_change_rate_minus1">slice_group_change_rate_minus1</a>                   = <var>0</var>; <i>/* XXX: unimplemented in FFmpeg */</i></td></tr>
<tr><th id="266">266</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::pic_init_qp_minus26" title='_VAPictureParameterBufferH264::pic_init_qp_minus26' data-ref="_VAPictureParameterBufferH264::pic_init_qp_minus26">pic_init_qp_minus26</a>                              = <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::init_qp" title='PPS::init_qp' data-ref="PPS::init_qp">init_qp</a> - <var>26</var>;</td></tr>
<tr><th id="267">267</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::pic_init_qs_minus26" title='_VAPictureParameterBufferH264::pic_init_qs_minus26' data-ref="_VAPictureParameterBufferH264::pic_init_qs_minus26">pic_init_qs_minus26</a>                              = <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::init_qs" title='PPS::init_qs' data-ref="PPS::init_qs">init_qs</a> - <var>26</var>;</td></tr>
<tr><th id="268">268</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::chroma_qp_index_offset" title='_VAPictureParameterBufferH264::chroma_qp_index_offset' data-ref="_VAPictureParameterBufferH264::chroma_qp_index_offset">chroma_qp_index_offset</a>                           = <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::chroma_qp_index_offset" title='PPS::chroma_qp_index_offset' data-ref="PPS::chroma_qp_index_offset">chroma_qp_index_offset</a>[<var>0</var>];</td></tr>
<tr><th id="269">269</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::second_chroma_qp_index_offset" title='_VAPictureParameterBufferH264::second_chroma_qp_index_offset' data-ref="_VAPictureParameterBufferH264::second_chroma_qp_index_offset">second_chroma_qp_index_offset</a>                    = <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::chroma_qp_index_offset" title='PPS::chroma_qp_index_offset' data-ref="PPS::chroma_qp_index_offset">chroma_qp_index_offset</a>[<var>1</var>];</td></tr>
<tr><th id="270">270</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::pic_fields" title='_VAPictureParameterBufferH264::pic_fields' data-ref="_VAPictureParameterBufferH264::pic_fields">pic_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::value" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::value' data-ref="_VAPictureParameterBufferH264::{anonymous}::value">value</a>                                 = <var>0</var>; <i>/* reset all bits */</i></td></tr>
<tr><th id="271">271</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::pic_fields" title='_VAPictureParameterBufferH264::pic_fields' data-ref="_VAPictureParameterBufferH264::pic_fields">pic_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::entropy_coding_mode_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::entropy_coding_mode_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::entropy_coding_mode_flag">entropy_coding_mode_flag</a>         = <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::cabac" title='PPS::cabac' data-ref="PPS::cabac">cabac</a>;</td></tr>
<tr><th id="272">272</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::pic_fields" title='_VAPictureParameterBufferH264::pic_fields' data-ref="_VAPictureParameterBufferH264::pic_fields">pic_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::weighted_pred_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::weighted_pred_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::weighted_pred_flag">weighted_pred_flag</a>               = <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::weighted_pred" title='PPS::weighted_pred' data-ref="PPS::weighted_pred">weighted_pred</a>;</td></tr>
<tr><th id="273">273</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::pic_fields" title='_VAPictureParameterBufferH264::pic_fields' data-ref="_VAPictureParameterBufferH264::pic_fields">pic_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::weighted_bipred_idc" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::weighted_bipred_idc' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::weighted_bipred_idc">weighted_bipred_idc</a>              = <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::weighted_bipred_idc" title='PPS::weighted_bipred_idc' data-ref="PPS::weighted_bipred_idc">weighted_bipred_idc</a>;</td></tr>
<tr><th id="274">274</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::pic_fields" title='_VAPictureParameterBufferH264::pic_fields' data-ref="_VAPictureParameterBufferH264::pic_fields">pic_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::transform_8x8_mode_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::transform_8x8_mode_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::transform_8x8_mode_flag">transform_8x8_mode_flag</a>          = <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::transform_8x8_mode" title='PPS::transform_8x8_mode' data-ref="PPS::transform_8x8_mode">transform_8x8_mode</a>;</td></tr>
<tr><th id="275">275</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::pic_fields" title='_VAPictureParameterBufferH264::pic_fields' data-ref="_VAPictureParameterBufferH264::pic_fields">pic_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::field_pic_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::field_pic_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::field_pic_flag">field_pic_flag</a>                   = <a class="local col5 ref" href="#35h" title='h' data-ref="35h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::picture_structure" title='H264Context::picture_structure' data-ref="H264Context::picture_structure">picture_structure</a> != <a class="macro" href="mpegutils.h.html#39" title="3" data-ref="_M/PICT_FRAME">PICT_FRAME</a>;</td></tr>
<tr><th id="276">276</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::pic_fields" title='_VAPictureParameterBufferH264::pic_fields' data-ref="_VAPictureParameterBufferH264::pic_fields">pic_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::constrained_intra_pred_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::constrained_intra_pred_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::constrained_intra_pred_flag">constrained_intra_pred_flag</a>      = <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::constrained_intra_pred" title='PPS::constrained_intra_pred' data-ref="PPS::constrained_intra_pred">constrained_intra_pred</a>;</td></tr>
<tr><th id="277">277</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::pic_fields" title='_VAPictureParameterBufferH264::pic_fields' data-ref="_VAPictureParameterBufferH264::pic_fields">pic_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::pic_order_present_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::pic_order_present_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::pic_order_present_flag">pic_order_present_flag</a>           = <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::pic_order_present" title='PPS::pic_order_present' data-ref="PPS::pic_order_present">pic_order_present</a>;</td></tr>
<tr><th id="278">278</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::pic_fields" title='_VAPictureParameterBufferH264::pic_fields' data-ref="_VAPictureParameterBufferH264::pic_fields">pic_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::deblocking_filter_control_present_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::deblocking_filter_control_present_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::deblocking_filter_control_present_flag">deblocking_filter_control_present_flag</a> = <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::deblocking_filter_parameters_present" title='PPS::deblocking_filter_parameters_present' data-ref="PPS::deblocking_filter_parameters_present">deblocking_filter_parameters_present</a>;</td></tr>
<tr><th id="279">279</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::pic_fields" title='_VAPictureParameterBufferH264::pic_fields' data-ref="_VAPictureParameterBufferH264::pic_fields">pic_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::redundant_pic_cnt_present_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::redundant_pic_cnt_present_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::redundant_pic_cnt_present_flag">redundant_pic_cnt_present_flag</a>   = <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::redundant_pic_cnt_present" title='PPS::redundant_pic_cnt_present' data-ref="PPS::redundant_pic_cnt_present">redundant_pic_cnt_present</a>;</td></tr>
<tr><th id="280">280</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::pic_fields" title='_VAPictureParameterBufferH264::pic_fields' data-ref="_VAPictureParameterBufferH264::pic_fields">pic_fields</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymous}::bits" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::bits' data-ref="_VAPictureParameterBufferH264::{anonymous}::bits">bits</a>.<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::reference_pic_flag" title='_VAPictureParameterBufferH264::&lt;anonymous union&gt;::&lt;anonymous struct&gt;::reference_pic_flag' data-ref="_VAPictureParameterBufferH264::{anonymousunion}::{anonymous}::reference_pic_flag">reference_pic_flag</a>               = <a class="local col5 ref" href="#35h" title='h' data-ref="35h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::nal_ref_idc" title='H264Context::nal_ref_idc' data-ref="H264Context::nal_ref_idc">nal_ref_idc</a> != <var>0</var>;</td></tr>
<tr><th id="281">281</th><td>    <a class="local col9 ref" href="#39pic_param" title='pic_param' data-ref="39pic_param">pic_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAPictureParameterBufferH264::frame_num" title='_VAPictureParameterBufferH264::frame_num' data-ref="_VAPictureParameterBufferH264::frame_num">frame_num</a>                                        = <a class="local col5 ref" href="#35h" title='h' data-ref="35h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::poc" title='H264Context::poc' data-ref="H264Context::poc">poc</a>.<a class="ref" href="h264_parse.h.html#H264POCContext::frame_num" title='H264POCContext::frame_num' data-ref="H264POCContext::frame_num">frame_num</a>;</td></tr>
<tr><th id="282">282</th><td></td></tr>
<tr><th id="283">283</th><td>    <i>/* Fill in VAIQMatrixBufferH264. */</i></td></tr>
<tr><th id="284">284</th><td>    <a class="local col0 ref" href="#40iq_matrix" title='iq_matrix' data-ref="40iq_matrix">iq_matrix</a> = <a class="ref" href="vaapi_internal.h.html#ff_vaapi_alloc_iq_matrix" title='ff_vaapi_alloc_iq_matrix' data-ref="ff_vaapi_alloc_iq_matrix">ff_vaapi_alloc_iq_matrix</a>(<a class="local col6 ref" href="#36vactx" title='vactx' data-ref="36vactx">vactx</a>, <b>sizeof</b>(<a class="typedef" href="../../include/va/va.h.html#VAIQMatrixBufferH264" title='VAIQMatrixBufferH264' data-type='struct _VAIQMatrixBufferH264' data-ref="VAIQMatrixBufferH264">VAIQMatrixBufferH264</a>));</td></tr>
<tr><th id="285">285</th><td>    <b>if</b> (!<a class="local col0 ref" href="#40iq_matrix" title='iq_matrix' data-ref="40iq_matrix">iq_matrix</a>)</td></tr>
<tr><th id="286">286</th><td>        <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="287">287</th><td>    <a class="ref" href="../../include/string.h.html#memcpy" title='memcpy' data-ref="memcpy">memcpy</a>(<a class="local col0 ref" href="#40iq_matrix" title='iq_matrix' data-ref="40iq_matrix">iq_matrix</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAIQMatrixBufferH264::ScalingList4x4" title='_VAIQMatrixBufferH264::ScalingList4x4' data-ref="_VAIQMatrixBufferH264::ScalingList4x4">ScalingList4x4</a>, <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::scaling_matrix4" title='PPS::scaling_matrix4' data-ref="PPS::scaling_matrix4">scaling_matrix4</a>, <b>sizeof</b>(<a class="local col0 ref" href="#40iq_matrix" title='iq_matrix' data-ref="40iq_matrix">iq_matrix</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAIQMatrixBufferH264::ScalingList4x4" title='_VAIQMatrixBufferH264::ScalingList4x4' data-ref="_VAIQMatrixBufferH264::ScalingList4x4">ScalingList4x4</a>));</td></tr>
<tr><th id="288">288</th><td>    <a class="ref" href="../../include/string.h.html#memcpy" title='memcpy' data-ref="memcpy">memcpy</a>(<a class="local col0 ref" href="#40iq_matrix" title='iq_matrix' data-ref="40iq_matrix">iq_matrix</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAIQMatrixBufferH264::ScalingList8x8" title='_VAIQMatrixBufferH264::ScalingList8x8' data-ref="_VAIQMatrixBufferH264::ScalingList8x8">ScalingList8x8</a>[<var>0</var>], <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::scaling_matrix8" title='PPS::scaling_matrix8' data-ref="PPS::scaling_matrix8">scaling_matrix8</a>[<var>0</var>], <b>sizeof</b>(<a class="local col0 ref" href="#40iq_matrix" title='iq_matrix' data-ref="40iq_matrix">iq_matrix</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAIQMatrixBufferH264::ScalingList8x8" title='_VAIQMatrixBufferH264::ScalingList8x8' data-ref="_VAIQMatrixBufferH264::ScalingList8x8">ScalingList8x8</a>[<var>0</var>]));</td></tr>
<tr><th id="289">289</th><td>    <a class="ref" href="../../include/string.h.html#memcpy" title='memcpy' data-ref="memcpy">memcpy</a>(<a class="local col0 ref" href="#40iq_matrix" title='iq_matrix' data-ref="40iq_matrix">iq_matrix</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAIQMatrixBufferH264::ScalingList8x8" title='_VAIQMatrixBufferH264::ScalingList8x8' data-ref="_VAIQMatrixBufferH264::ScalingList8x8">ScalingList8x8</a>[<var>1</var>], <a class="local col7 ref" href="#37pps" title='pps' data-ref="37pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::scaling_matrix8" title='PPS::scaling_matrix8' data-ref="PPS::scaling_matrix8">scaling_matrix8</a>[<var>3</var>], <b>sizeof</b>(<a class="local col0 ref" href="#40iq_matrix" title='iq_matrix' data-ref="40iq_matrix">iq_matrix</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VAIQMatrixBufferH264::ScalingList8x8" title='_VAIQMatrixBufferH264::ScalingList8x8' data-ref="_VAIQMatrixBufferH264::ScalingList8x8">ScalingList8x8</a>[<var>0</var>]));</td></tr>
<tr><th id="290">290</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="291">291</th><td>}</td></tr>
<tr><th id="292">292</th><td></td></tr>
<tr><th id="293">293</th><td><i class="doc" data-doc="vaapi_h264_end_frame">/** End a hardware decoding based frame. */</i></td></tr>
<tr><th id="294">294</th><td><em>static</em> <em>int</em> <dfn class="tu decl def" id="vaapi_h264_end_frame" title='vaapi_h264_end_frame' data-type='int vaapi_h264_end_frame(AVCodecContext * avctx)' data-ref="vaapi_h264_end_frame">vaapi_h264_end_frame</dfn>(<a class="typedef" href="avcodec.h.html#AVCodecContext" title='AVCodecContext' data-type='struct AVCodecContext' data-ref="AVCodecContext">AVCodecContext</a> *<dfn class="local col1 decl" id="41avctx" title='avctx' data-type='AVCodecContext *' data-ref="41avctx">avctx</dfn>)</td></tr>
<tr><th id="295">295</th><td>{</td></tr>
<tr><th id="296">296</th><td>    <a class="typedef" href="vaapi_internal.h.html#FFVAContext" title='FFVAContext' data-type='struct FFVAContext' data-ref="FFVAContext">FFVAContext</a> * <em>const</em> <dfn class="local col2 decl" id="42vactx" title='vactx' data-type='FFVAContext *const' data-ref="42vactx">vactx</dfn> = <a class="ref" href="vaapi_internal.h.html#ff_vaapi_get_context" title='ff_vaapi_get_context' data-ref="ff_vaapi_get_context">ff_vaapi_get_context</a>(<a class="local col1 ref" href="#41avctx" title='avctx' data-ref="41avctx">avctx</a>);</td></tr>
<tr><th id="297">297</th><td>    <a class="typedef" href="h264dec.h.html#H264Context" title='H264Context' data-type='struct H264Context' data-ref="H264Context">H264Context</a> * <em>const</em> <dfn class="local col3 decl" id="43h" title='h' data-type='H264Context *const' data-ref="43h">h</dfn> = <a class="local col1 ref" href="#41avctx" title='avctx' data-ref="41avctx">avctx</a>-&gt;<a class="ref" href="avcodec.h.html#AVCodecContext::priv_data" title='AVCodecContext::priv_data' data-ref="AVCodecContext::priv_data">priv_data</a>;</td></tr>
<tr><th id="298">298</th><td>    <a class="typedef" href="h264dec.h.html#H264SliceContext" title='H264SliceContext' data-type='struct H264SliceContext' data-ref="H264SliceContext">H264SliceContext</a> *<dfn class="local col4 decl" id="44sl" title='sl' data-type='H264SliceContext *' data-ref="44sl">sl</dfn> = &amp;<a class="local col3 ref" href="#43h" title='h' data-ref="43h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::slice_ctx" title='H264Context::slice_ctx' data-ref="H264Context::slice_ctx">slice_ctx</a>[<var>0</var>];</td></tr>
<tr><th id="299">299</th><td>    <em>int</em> <dfn class="local col5 decl" id="45ret" title='ret' data-type='int' data-ref="45ret">ret</dfn>;</td></tr>
<tr><th id="300">300</th><td></td></tr>
<tr><th id="301">301</th><td>    <a class="local col5 ref" href="#45ret" title='ret' data-ref="45ret">ret</a> = <a class="ref" href="vaapi_internal.h.html#ff_vaapi_commit_slices" title='ff_vaapi_commit_slices' data-ref="ff_vaapi_commit_slices">ff_vaapi_commit_slices</a>(<a class="local col2 ref" href="#42vactx" title='vactx' data-ref="42vactx">vactx</a>);</td></tr>
<tr><th id="302">302</th><td>    <b>if</b> (<a class="local col5 ref" href="#45ret" title='ret' data-ref="45ret">ret</a> &lt; <var>0</var>)</td></tr>
<tr><th id="303">303</th><td>        <b>goto</b> <a class="lbl" href="#46finish" data-ref="46finish">finish</a>;</td></tr>
<tr><th id="304">304</th><td></td></tr>
<tr><th id="305">305</th><td>    <a class="local col5 ref" href="#45ret" title='ret' data-ref="45ret">ret</a> = <a class="ref" href="vaapi_internal.h.html#ff_vaapi_render_picture" title='ff_vaapi_render_picture' data-ref="ff_vaapi_render_picture">ff_vaapi_render_picture</a>(<a class="local col2 ref" href="#42vactx" title='vactx' data-ref="42vactx">vactx</a>, <a class="ref" href="vaapi_internal.h.html#ff_vaapi_get_surface_id" title='ff_vaapi_get_surface_id' data-ref="ff_vaapi_get_surface_id">ff_vaapi_get_surface_id</a>(<a class="local col3 ref" href="#43h" title='h' data-ref="43h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::cur_pic_ptr" title='H264Context::cur_pic_ptr' data-ref="H264Context::cur_pic_ptr">cur_pic_ptr</a>-&gt;<a class="ref" href="h264dec.h.html#H264Picture::f" title='H264Picture::f' data-ref="H264Picture::f">f</a>));</td></tr>
<tr><th id="306">306</th><td>    <b>if</b> (<a class="local col5 ref" href="#45ret" title='ret' data-ref="45ret">ret</a> &lt; <var>0</var>)</td></tr>
<tr><th id="307">307</th><td>        <b>goto</b> <a class="lbl" href="#46finish" data-ref="46finish">finish</a>;</td></tr>
<tr><th id="308">308</th><td></td></tr>
<tr><th id="309">309</th><td>    <a class="ref" href="h264dec.h.html#ff_h264_draw_horiz_band" title='ff_h264_draw_horiz_band' data-ref="ff_h264_draw_horiz_band">ff_h264_draw_horiz_band</a>(<a class="local col3 ref" href="#43h" title='h' data-ref="43h">h</a>, <a class="local col4 ref" href="#44sl" title='sl' data-ref="44sl">sl</a>, <var>0</var>, <a class="local col3 ref" href="#43h" title='h' data-ref="43h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::avctx" title='H264Context::avctx' data-ref="H264Context::avctx">avctx</a>-&gt;<a class="ref" href="avcodec.h.html#AVCodecContext::height" title='AVCodecContext::height' data-ref="AVCodecContext::height">height</a>);</td></tr>
<tr><th id="310">310</th><td></td></tr>
<tr><th id="311">311</th><td><dfn class="lbl" id="46finish" data-ref="46finish">finish</dfn>:</td></tr>
<tr><th id="312">312</th><td>    <a class="ref" href="vaapi_internal.h.html#ff_vaapi_common_end_frame" title='ff_vaapi_common_end_frame' data-ref="ff_vaapi_common_end_frame">ff_vaapi_common_end_frame</a>(<a class="local col1 ref" href="#41avctx" title='avctx' data-ref="41avctx">avctx</a>);</td></tr>
<tr><th id="313">313</th><td>    <b>return</b> <a class="local col5 ref" href="#45ret" title='ret' data-ref="45ret">ret</a>;</td></tr>
<tr><th id="314">314</th><td>}</td></tr>
<tr><th id="315">315</th><td></td></tr>
<tr><th id="316">316</th><td><i class="doc" data-doc="vaapi_h264_decode_slice">/** Decode the given H.264 slice with VA API. */</i></td></tr>
<tr><th id="317">317</th><td><em>static</em> <em>int</em> <dfn class="tu decl def" id="vaapi_h264_decode_slice" title='vaapi_h264_decode_slice' data-type='int vaapi_h264_decode_slice(AVCodecContext * avctx, const uint8_t * buffer, uint32_t size)' data-ref="vaapi_h264_decode_slice">vaapi_h264_decode_slice</dfn>(<a class="typedef" href="avcodec.h.html#AVCodecContext" title='AVCodecContext' data-type='struct AVCodecContext' data-ref="AVCodecContext">AVCodecContext</a> *<dfn class="local col7 decl" id="47avctx" title='avctx' data-type='AVCodecContext *' data-ref="47avctx">avctx</dfn>,</td></tr>
<tr><th id="318">318</th><td>                                   <em>const</em> <a class="typedef" href="../../include/stdint.h.html#uint8_t" title='uint8_t' data-type='unsigned char' data-ref="uint8_t">uint8_t</a>  *<dfn class="local col8 decl" id="48buffer" title='buffer' data-type='const uint8_t *' data-ref="48buffer">buffer</dfn>,</td></tr>
<tr><th id="319">319</th><td>                                   <a class="typedef" href="../../include/stdint.h.html#uint32_t" title='uint32_t' data-type='unsigned int' data-ref="uint32_t">uint32_t</a>        <dfn class="local col9 decl" id="49size" title='size' data-type='uint32_t' data-ref="49size">size</dfn>)</td></tr>
<tr><th id="320">320</th><td>{</td></tr>
<tr><th id="321">321</th><td>    <a class="typedef" href="vaapi_internal.h.html#FFVAContext" title='FFVAContext' data-type='struct FFVAContext' data-ref="FFVAContext">FFVAContext</a> * <em>const</em> <dfn class="local col0 decl" id="50vactx" title='vactx' data-type='FFVAContext *const' data-ref="50vactx">vactx</dfn> = <a class="ref" href="vaapi_internal.h.html#ff_vaapi_get_context" title='ff_vaapi_get_context' data-ref="ff_vaapi_get_context">ff_vaapi_get_context</a>(<a class="local col7 ref" href="#47avctx" title='avctx' data-ref="47avctx">avctx</a>);</td></tr>
<tr><th id="322">322</th><td>    <a class="typedef" href="h264dec.h.html#H264Context" title='H264Context' data-type='struct H264Context' data-ref="H264Context">H264Context</a> * <em>const</em> <dfn class="local col1 decl" id="51h" title='h' data-type='H264Context *const' data-ref="51h">h</dfn> = <a class="local col7 ref" href="#47avctx" title='avctx' data-ref="47avctx">avctx</a>-&gt;<a class="ref" href="avcodec.h.html#AVCodecContext::priv_data" title='AVCodecContext::priv_data' data-ref="AVCodecContext::priv_data">priv_data</a>;</td></tr>
<tr><th id="323">323</th><td>    <a class="typedef" href="h264dec.h.html#H264SliceContext" title='H264SliceContext' data-type='struct H264SliceContext' data-ref="H264SliceContext">H264SliceContext</a> *<dfn class="local col2 decl" id="52sl" title='sl' data-type='H264SliceContext *' data-ref="52sl">sl</dfn>  = &amp;<a class="local col1 ref" href="#51h" title='h' data-ref="51h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::slice_ctx" title='H264Context::slice_ctx' data-ref="H264Context::slice_ctx">slice_ctx</a>[<var>0</var>];</td></tr>
<tr><th id="324">324</th><td>    <a class="typedef" href="../../include/va/va.h.html#VASliceParameterBufferH264" title='VASliceParameterBufferH264' data-type='struct _VASliceParameterBufferH264' data-ref="VASliceParameterBufferH264">VASliceParameterBufferH264</a> *<dfn class="local col3 decl" id="53slice_param" title='slice_param' data-type='VASliceParameterBufferH264 *' data-ref="53slice_param">slice_param</dfn>;</td></tr>
<tr><th id="325">325</th><td></td></tr>
<tr><th id="326">326</th><td>    <i>/* Fill in VASliceParameterBufferH264. */</i></td></tr>
<tr><th id="327">327</th><td>    <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a> = (<a class="typedef" href="../../include/va/va.h.html#VASliceParameterBufferH264" title='VASliceParameterBufferH264' data-type='struct _VASliceParameterBufferH264' data-ref="VASliceParameterBufferH264">VASliceParameterBufferH264</a> *)<a class="ref" href="vaapi_internal.h.html#ff_vaapi_alloc_slice" title='ff_vaapi_alloc_slice' data-ref="ff_vaapi_alloc_slice">ff_vaapi_alloc_slice</a>(<a class="local col0 ref" href="#50vactx" title='vactx' data-ref="50vactx">vactx</a>, <a class="local col8 ref" href="#48buffer" title='buffer' data-ref="48buffer">buffer</a>, <a class="local col9 ref" href="#49size" title='size' data-ref="49size">size</a>);</td></tr>
<tr><th id="328">328</th><td>    <b>if</b> (!<a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>)</td></tr>
<tr><th id="329">329</th><td>        <b>return</b> -<var>1</var>;</td></tr>
<tr><th id="330">330</th><td>    <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::slice_data_bit_offset" title='_VASliceParameterBufferH264::slice_data_bit_offset' data-ref="_VASliceParameterBufferH264::slice_data_bit_offset">slice_data_bit_offset</a>          = <a class="ref" href="get_bits.h.html#get_bits_count" title='get_bits_count' data-ref="get_bits_count">get_bits_count</a>(&amp;<a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::gb" title='H264SliceContext::gb' data-ref="H264SliceContext::gb">gb</a>);</td></tr>
<tr><th id="331">331</th><td>    <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::first_mb_in_slice" title='_VASliceParameterBufferH264::first_mb_in_slice' data-ref="_VASliceParameterBufferH264::first_mb_in_slice">first_mb_in_slice</a>              = (<a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::mb_y" title='H264SliceContext::mb_y' data-ref="H264SliceContext::mb_y">mb_y</a> &gt;&gt; <a class="macro" href="h264dec.h.html#91" title="((h)-&gt;mb_aff_frame || ((h)-&gt;picture_structure != 3))" data-ref="_M/FIELD_OR_MBAFF_PICTURE">FIELD_OR_MBAFF_PICTURE</a>(<a class="local col1 ref" href="#51h" title='h' data-ref="51h">h</a>)) * <a class="local col1 ref" href="#51h" title='h' data-ref="51h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::mb_width" title='H264Context::mb_width' data-ref="H264Context::mb_width">mb_width</a> + <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::mb_x" title='H264SliceContext::mb_x' data-ref="H264SliceContext::mb_x">mb_x</a>;</td></tr>
<tr><th id="332">332</th><td>    <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::slice_type" title='_VASliceParameterBufferH264::slice_type' data-ref="_VASliceParameterBufferH264::slice_type">slice_type</a>                     = <a class="ref" href="h264dec.h.html#ff_h264_get_slice_type" title='ff_h264_get_slice_type' data-ref="ff_h264_get_slice_type">ff_h264_get_slice_type</a>(<a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>);</td></tr>
<tr><th id="333">333</th><td>    <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::direct_spatial_mv_pred_flag" title='_VASliceParameterBufferH264::direct_spatial_mv_pred_flag' data-ref="_VASliceParameterBufferH264::direct_spatial_mv_pred_flag">direct_spatial_mv_pred_flag</a>    = <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::slice_type" title='H264SliceContext::slice_type' data-ref="H264SliceContext::slice_type">slice_type</a> == <a class="enum" href="../libavutil/avutil.h.html#AVPictureType::AV_PICTURE_TYPE_B" title='AVPictureType::AV_PICTURE_TYPE_B' data-ref="AVPictureType::AV_PICTURE_TYPE_B">AV_PICTURE_TYPE_B</a> ? <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::direct_spatial_mv_pred" title='H264SliceContext::direct_spatial_mv_pred' data-ref="H264SliceContext::direct_spatial_mv_pred">direct_spatial_mv_pred</a> : <var>0</var>;</td></tr>
<tr><th id="334">334</th><td>    <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::num_ref_idx_l0_active_minus1" title='_VASliceParameterBufferH264::num_ref_idx_l0_active_minus1' data-ref="_VASliceParameterBufferH264::num_ref_idx_l0_active_minus1">num_ref_idx_l0_active_minus1</a>   = <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::list_count" title='H264SliceContext::list_count' data-ref="H264SliceContext::list_count">list_count</a> &gt; <var>0</var> ? <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::ref_count" title='H264SliceContext::ref_count' data-ref="H264SliceContext::ref_count">ref_count</a>[<var>0</var>] - <var>1</var> : <var>0</var>;</td></tr>
<tr><th id="335">335</th><td>    <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::num_ref_idx_l1_active_minus1" title='_VASliceParameterBufferH264::num_ref_idx_l1_active_minus1' data-ref="_VASliceParameterBufferH264::num_ref_idx_l1_active_minus1">num_ref_idx_l1_active_minus1</a>   = <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::list_count" title='H264SliceContext::list_count' data-ref="H264SliceContext::list_count">list_count</a> &gt; <var>1</var> ? <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::ref_count" title='H264SliceContext::ref_count' data-ref="H264SliceContext::ref_count">ref_count</a>[<var>1</var>] - <var>1</var> : <var>0</var>;</td></tr>
<tr><th id="336">336</th><td>    <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::cabac_init_idc" title='_VASliceParameterBufferH264::cabac_init_idc' data-ref="_VASliceParameterBufferH264::cabac_init_idc">cabac_init_idc</a>                 = <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::cabac_init_idc" title='H264SliceContext::cabac_init_idc' data-ref="H264SliceContext::cabac_init_idc">cabac_init_idc</a>;</td></tr>
<tr><th id="337">337</th><td>    <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::slice_qp_delta" title='_VASliceParameterBufferH264::slice_qp_delta' data-ref="_VASliceParameterBufferH264::slice_qp_delta">slice_qp_delta</a>                 = <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::qscale" title='H264SliceContext::qscale' data-ref="H264SliceContext::qscale">qscale</a> - <a class="local col1 ref" href="#51h" title='h' data-ref="51h">h</a>-&gt;<a class="ref" href="h264dec.h.html#H264Context::ps" title='H264Context::ps' data-ref="H264Context::ps">ps</a>.<a class="ref" href="h264_ps.h.html#H264ParamSets::pps" title='H264ParamSets::pps' data-ref="H264ParamSets::pps">pps</a>-&gt;<a class="ref" href="h264_ps.h.html#PPS::init_qp" title='PPS::init_qp' data-ref="PPS::init_qp">init_qp</a>;</td></tr>
<tr><th id="338">338</th><td>    <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::disable_deblocking_filter_idc" title='_VASliceParameterBufferH264::disable_deblocking_filter_idc' data-ref="_VASliceParameterBufferH264::disable_deblocking_filter_idc">disable_deblocking_filter_idc</a>  = <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::deblocking_filter" title='H264SliceContext::deblocking_filter' data-ref="H264SliceContext::deblocking_filter">deblocking_filter</a> &lt; <var>2</var> ? !<a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::deblocking_filter" title='H264SliceContext::deblocking_filter' data-ref="H264SliceContext::deblocking_filter">deblocking_filter</a> : <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::deblocking_filter" title='H264SliceContext::deblocking_filter' data-ref="H264SliceContext::deblocking_filter">deblocking_filter</a>;</td></tr>
<tr><th id="339">339</th><td>    <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::slice_alpha_c0_offset_div2" title='_VASliceParameterBufferH264::slice_alpha_c0_offset_div2' data-ref="_VASliceParameterBufferH264::slice_alpha_c0_offset_div2">slice_alpha_c0_offset_div2</a>     = <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::slice_alpha_c0_offset" title='H264SliceContext::slice_alpha_c0_offset' data-ref="H264SliceContext::slice_alpha_c0_offset">slice_alpha_c0_offset</a> / <var>2</var>;</td></tr>
<tr><th id="340">340</th><td>    <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::slice_beta_offset_div2" title='_VASliceParameterBufferH264::slice_beta_offset_div2' data-ref="_VASliceParameterBufferH264::slice_beta_offset_div2">slice_beta_offset_div2</a>         = <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::slice_beta_offset" title='H264SliceContext::slice_beta_offset' data-ref="H264SliceContext::slice_beta_offset">slice_beta_offset</a>     / <var>2</var>;</td></tr>
<tr><th id="341">341</th><td>    <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::luma_log2_weight_denom" title='_VASliceParameterBufferH264::luma_log2_weight_denom' data-ref="_VASliceParameterBufferH264::luma_log2_weight_denom">luma_log2_weight_denom</a>         = <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::pwt" title='H264SliceContext::pwt' data-ref="H264SliceContext::pwt">pwt</a>.<a class="ref" href="h264_parse.h.html#H264PredWeightTable::luma_log2_weight_denom" title='H264PredWeightTable::luma_log2_weight_denom' data-ref="H264PredWeightTable::luma_log2_weight_denom">luma_log2_weight_denom</a>;</td></tr>
<tr><th id="342">342</th><td>    <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::chroma_log2_weight_denom" title='_VASliceParameterBufferH264::chroma_log2_weight_denom' data-ref="_VASliceParameterBufferH264::chroma_log2_weight_denom">chroma_log2_weight_denom</a>       = <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::pwt" title='H264SliceContext::pwt' data-ref="H264SliceContext::pwt">pwt</a>.<a class="ref" href="h264_parse.h.html#H264PredWeightTable::chroma_log2_weight_denom" title='H264PredWeightTable::chroma_log2_weight_denom' data-ref="H264PredWeightTable::chroma_log2_weight_denom">chroma_log2_weight_denom</a>;</td></tr>
<tr><th id="343">343</th><td></td></tr>
<tr><th id="344">344</th><td>    <a class="tu ref" href="#fill_vaapi_RefPicList" title='fill_vaapi_RefPicList' data-use='c' data-ref="fill_vaapi_RefPicList">fill_vaapi_RefPicList</a>(<a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::RefPicList0" title='_VASliceParameterBufferH264::RefPicList0' data-ref="_VASliceParameterBufferH264::RefPicList0">RefPicList0</a>, <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::ref_list" title='H264SliceContext::ref_list' data-ref="H264SliceContext::ref_list">ref_list</a>[<var>0</var>], <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::list_count" title='H264SliceContext::list_count' data-ref="H264SliceContext::list_count">list_count</a> &gt; <var>0</var> ? <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::ref_count" title='H264SliceContext::ref_count' data-ref="H264SliceContext::ref_count">ref_count</a>[<var>0</var>] : <var>0</var>);</td></tr>
<tr><th id="345">345</th><td>    <a class="tu ref" href="#fill_vaapi_RefPicList" title='fill_vaapi_RefPicList' data-use='c' data-ref="fill_vaapi_RefPicList">fill_vaapi_RefPicList</a>(<a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::RefPicList1" title='_VASliceParameterBufferH264::RefPicList1' data-ref="_VASliceParameterBufferH264::RefPicList1">RefPicList1</a>, <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::ref_list" title='H264SliceContext::ref_list' data-ref="H264SliceContext::ref_list">ref_list</a>[<var>1</var>], <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::list_count" title='H264SliceContext::list_count' data-ref="H264SliceContext::list_count">list_count</a> &gt; <var>1</var> ? <a class="local col2 ref" href="#52sl" title='sl' data-ref="52sl">sl</a>-&gt;<a class="ref" href="h264dec.h.html#H264SliceContext::ref_count" title='H264SliceContext::ref_count' data-ref="H264SliceContext::ref_count">ref_count</a>[<var>1</var>] : <var>0</var>);</td></tr>
<tr><th id="346">346</th><td></td></tr>
<tr><th id="347">347</th><td>    <a class="tu ref" href="#fill_vaapi_plain_pred_weight_table" title='fill_vaapi_plain_pred_weight_table' data-use='c' data-ref="fill_vaapi_plain_pred_weight_table">fill_vaapi_plain_pred_weight_table</a>(<a class="local col1 ref" href="#51h" title='h' data-ref="51h">h</a>, <var>0</var>,</td></tr>
<tr><th id="348">348</th><td>                                       &amp;<a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::luma_weight_l0_flag" title='_VASliceParameterBufferH264::luma_weight_l0_flag' data-ref="_VASliceParameterBufferH264::luma_weight_l0_flag">luma_weight_l0_flag</a>,   <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::luma_weight_l0" title='_VASliceParameterBufferH264::luma_weight_l0' data-ref="_VASliceParameterBufferH264::luma_weight_l0">luma_weight_l0</a>,   <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::luma_offset_l0" title='_VASliceParameterBufferH264::luma_offset_l0' data-ref="_VASliceParameterBufferH264::luma_offset_l0">luma_offset_l0</a>,</td></tr>
<tr><th id="349">349</th><td>                                       &amp;<a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::chroma_weight_l0_flag" title='_VASliceParameterBufferH264::chroma_weight_l0_flag' data-ref="_VASliceParameterBufferH264::chroma_weight_l0_flag">chroma_weight_l0_flag</a>, <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::chroma_weight_l0" title='_VASliceParameterBufferH264::chroma_weight_l0' data-ref="_VASliceParameterBufferH264::chroma_weight_l0">chroma_weight_l0</a>, <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::chroma_offset_l0" title='_VASliceParameterBufferH264::chroma_offset_l0' data-ref="_VASliceParameterBufferH264::chroma_offset_l0">chroma_offset_l0</a>);</td></tr>
<tr><th id="350">350</th><td>    <a class="tu ref" href="#fill_vaapi_plain_pred_weight_table" title='fill_vaapi_plain_pred_weight_table' data-use='c' data-ref="fill_vaapi_plain_pred_weight_table">fill_vaapi_plain_pred_weight_table</a>(<a class="local col1 ref" href="#51h" title='h' data-ref="51h">h</a>, <var>1</var>,</td></tr>
<tr><th id="351">351</th><td>                                       &amp;<a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::luma_weight_l1_flag" title='_VASliceParameterBufferH264::luma_weight_l1_flag' data-ref="_VASliceParameterBufferH264::luma_weight_l1_flag">luma_weight_l1_flag</a>,   <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::luma_weight_l1" title='_VASliceParameterBufferH264::luma_weight_l1' data-ref="_VASliceParameterBufferH264::luma_weight_l1">luma_weight_l1</a>,   <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::luma_offset_l1" title='_VASliceParameterBufferH264::luma_offset_l1' data-ref="_VASliceParameterBufferH264::luma_offset_l1">luma_offset_l1</a>,</td></tr>
<tr><th id="352">352</th><td>                                       &amp;<a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::chroma_weight_l1_flag" title='_VASliceParameterBufferH264::chroma_weight_l1_flag' data-ref="_VASliceParameterBufferH264::chroma_weight_l1_flag">chroma_weight_l1_flag</a>, <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::chroma_weight_l1" title='_VASliceParameterBufferH264::chroma_weight_l1' data-ref="_VASliceParameterBufferH264::chroma_weight_l1">chroma_weight_l1</a>, <a class="local col3 ref" href="#53slice_param" title='slice_param' data-ref="53slice_param">slice_param</a>-&gt;<a class="ref" href="../../include/va/va.h.html#_VASliceParameterBufferH264::chroma_offset_l1" title='_VASliceParameterBufferH264::chroma_offset_l1' data-ref="_VASliceParameterBufferH264::chroma_offset_l1">chroma_offset_l1</a>);</td></tr>
<tr><th id="353">353</th><td>    <b>return</b> <var>0</var>;</td></tr>
<tr><th id="354">354</th><td>}</td></tr>
<tr><th id="355">355</th><td></td></tr>
<tr><th id="356">356</th><td><a class="typedef" href="avcodec.h.html#AVHWAccel" title='AVHWAccel' data-type='struct AVHWAccel' data-ref="AVHWAccel">AVHWAccel</a> <dfn class="decl def" id="ff_h264_vaapi_hwaccel" title='ff_h264_vaapi_hwaccel' data-ref="ff_h264_vaapi_hwaccel">ff_h264_vaapi_hwaccel</dfn> = {</td></tr>
<tr><th id="357">357</th><td>    .<a class="ref" href="avcodec.h.html#AVHWAccel::name" title='AVHWAccel::name' data-ref="AVHWAccel::name">name</a>           = <q>"h264_vaapi"</q>,</td></tr>
<tr><th id="358">358</th><td>    .<a class="ref" href="avcodec.h.html#AVHWAccel::type" title='AVHWAccel::type' data-ref="AVHWAccel::type">type</a>           = <a class="enum" href="../libavutil/avutil.h.html#AVMediaType::AVMEDIA_TYPE_VIDEO" title='AVMediaType::AVMEDIA_TYPE_VIDEO' data-ref="AVMediaType::AVMEDIA_TYPE_VIDEO">AVMEDIA_TYPE_VIDEO</a>,</td></tr>
<tr><th id="359">359</th><td>    .<a class="ref" href="avcodec.h.html#AVHWAccel::id" title='AVHWAccel::id' data-ref="AVHWAccel::id">id</a>             = <a class="enum" href="avcodec.h.html#AVCodecID::AV_CODEC_ID_H264" title='AVCodecID::AV_CODEC_ID_H264' data-ref="AVCodecID::AV_CODEC_ID_H264">AV_CODEC_ID_H264</a>,</td></tr>
<tr><th id="360">360</th><td>    .<a class="ref" href="avcodec.h.html#AVHWAccel::pix_fmt" title='AVHWAccel::pix_fmt' data-ref="AVHWAccel::pix_fmt">pix_fmt</a>        = <a class="enum" href="../libavutil/pixfmt.h.html#AVPixelFormat::AV_PIX_FMT_VAAPI" title='AVPixelFormat::AV_PIX_FMT_VAAPI' data-ref="AVPixelFormat::AV_PIX_FMT_VAAPI">AV_PIX_FMT_VAAPI</a>,</td></tr>
<tr><th id="361">361</th><td>    .<a class="ref" href="avcodec.h.html#AVHWAccel::start_frame" title='AVHWAccel::start_frame' data-ref="AVHWAccel::start_frame">start_frame</a>    = <a class="tu ref" href="#vaapi_h264_start_frame" title='vaapi_h264_start_frame' data-ref="vaapi_h264_start_frame">vaapi_h264_start_frame</a>,</td></tr>
<tr><th id="362">362</th><td>    .<a class="ref" href="avcodec.h.html#AVHWAccel::end_frame" title='AVHWAccel::end_frame' data-ref="AVHWAccel::end_frame">end_frame</a>      = <a class="tu ref" href="#vaapi_h264_end_frame" title='vaapi_h264_end_frame' data-ref="vaapi_h264_end_frame">vaapi_h264_end_frame</a>,</td></tr>
<tr><th id="363">363</th><td>    .<a class="ref" href="avcodec.h.html#AVHWAccel::decode_slice" title='AVHWAccel::decode_slice' data-ref="AVHWAccel::decode_slice">decode_slice</a>   = <a class="tu ref" href="#vaapi_h264_decode_slice" title='vaapi_h264_decode_slice' data-ref="vaapi_h264_decode_slice">vaapi_h264_decode_slice</a>,</td></tr>
<tr><th id="364">364</th><td>    .<a class="ref" href="avcodec.h.html#AVHWAccel::init" title='AVHWAccel::init' data-ref="AVHWAccel::init">init</a>           = <a class="ref" href="vaapi_internal.h.html#ff_vaapi_context_init" title='ff_vaapi_context_init' data-ref="ff_vaapi_context_init">ff_vaapi_context_init</a>,</td></tr>
<tr><th id="365">365</th><td>    .<a class="ref" href="avcodec.h.html#AVHWAccel::uninit" title='AVHWAccel::uninit' data-ref="AVHWAccel::uninit">uninit</a>         = <a class="ref" href="vaapi_internal.h.html#ff_vaapi_context_fini" title='ff_vaapi_context_fini' data-ref="ff_vaapi_context_fini">ff_vaapi_context_fini</a>,</td></tr>
<tr><th id="366">366</th><td>    .<a class="ref" href="avcodec.h.html#AVHWAccel::priv_data_size" title='AVHWAccel::priv_data_size' data-ref="AVHWAccel::priv_data_size">priv_data_size</a> = <b>sizeof</b>(<a class="typedef" href="vaapi_internal.h.html#FFVAContext" title='FFVAContext' data-type='struct FFVAContext' data-ref="FFVAContext">FFVAContext</a>),</td></tr>
<tr><th id="367">367</th><td>};</td></tr>
<tr><th id="368">368</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2016-Oct-25</em> from project ffmpeg revision <em>3.0.git</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.0.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
